<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <link rel="shortcut icon" href="img/home.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Data Engineering Blog</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet" type='text/css'>


  <!-- Custom styles for this template -->
  <link href="css/agency.min.css" rel="stylesheet">

</head>

<body id="page-top">

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand mb-0 h1 js-scroll-trigger" href="#page-top">Devesh Sharma</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav text-uppercase ml-auto">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#setup">Setup</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#extract">Extract</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#transform">Transform</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#load">Load</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#about">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="masthead">
    <div class="container">
      <div class="intro-text">
        <div class="intro-lead-in">Predicting Car Prices</div>
        <div class="intro-heading text-uppercase">An ETL Pipeline</div>
        <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="#intro">Get Started</a>
      </div>
    </div>
  </header>

  <section class="page-section" id="intro">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">About this Project</h2>
          <p class="primary" style="font-size:18px"><a href="https://www.sas.com/en_us/insights/data-management/what-is-etl.html"><b>ETL (Extract, Transform, Load)</b></a> is the integration process of obtaining raw data and migrating it to a Data Warehouse.
          It focuses on preparing Big Data for industrial processes such as Data Analysis and Machine Learning.</p>
          <p class="primary" style="font-size:18px">This project engineers Pyspark parallelization to load millions of American <a href="https://www.kaggle.com/austinreese/craigslist-carstrucks-data">car sale records</a>
            and processes them to understand various predictors of price through an ETL Pipeline. Why Spark? <i>SPEED</i> and Efficient Scalability. </p>
          <p class="primary" style="font-size:14px">Tools used --> <a href="https://www.python.org/">Python 3.7</a>, <a href="https://jupyter.org/">Jupyter Notebook</a>,
            <a href="https://spark.apache.org/">Apache Spark</a>, <a href="https://pandas.pydata.org/">Pandas</a>, <a href="https://aws.amazon.com/s3/">Amazon S3</a>, and
            <a href="https://www.howtogeek.com/67469/the-beginners-guide-to-shell-scripting-the-basics/">Shell Scripting</a>.</p>
        </div>
      </div>
  </div>

    <!-- Plotly.js -->

        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <!-- Plotly chart will be drawn inside this DIV -->
        <div id="myDiv">
        </div>
        <script>
        /* JAVASCRIPT CODE GOES HERE */


        Plotly.d3.csv('https://raw.githubusercontent.com/devsharma96/Car-Price-Prediction/master/data/statecount.csv', function(err, rows){
      function unpack(rows, key) {
          return rows.map(function(row) { return row[key]; });
      }

    var data = [{
        type: 'choropleth',
        locationmode: 'USA-states',
        locations: unpack(rows, 'State'),
        z: unpack(rows, 'Count'),
        text: unpack(rows, 'State'),
        autocolorscale: true
    }];

    var layout = {
      title: 'Distribution across States',
      geo: {
        scope: 'usa',
      countrycolor: 'rgb(255, 255, 255)',
      showland: true,
      landcolor: 'rgb(217, 217, 217)',
      showlakes: true,
      lakecolor: 'rgb(255, 255, 255)',
      subunitcolor: 'rgb(255, 255, 255)',
      lonaxis: {},
      lataxis: {}
      }
    };

    Plotly.plot(myDiv, data, layout, {showLink: false});

});
        </script>


  </section>

  <!-- Installation Setup -->
  <section class="bg-light page-section" id="setup">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">Installation Setup</h2>
          <h3 class="section-subheading text-muted">Configuring Apache Spark Cluster using Pyspark in a Jupyter Notebook.</h3>
        </div>
      </div>
      <div class="row text-center">
        <div class="col-md-4">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_environment_config">
          <span class="fa-stack fa-4x">
            <i class="fas fa-circle fa-stack-2x text-primary"></i>
            <i class="fas fa-laptop fa-stack-1x fa-inverse"></i>
          </span>
          <h4 class="service-heading">Environment Config.</h4>
          <p class="text-muted">The pipeline runs on a standalone Spark cluster accessed through a Jupyter Notebook. Won't run if dependencies
          aren't setup properly. </p>
        </a>
        </div>
        <div class="col-md-4">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_python_packages">
          <span class="fa-stack fa-4x">
            <i class="fas fa-circle fa-stack-2x text-primary"></i>
            <i class="fab fa-python fa-stack-1x fa-inverse"></i>
          </span>
          <h4 class="service-heading">Python Packages</h4>
          <p class="text-muted">Selecting appropriate Python libraries for Data transformations. The usual suspects - numpy, matplotlib, etc.</p>
          </a>
        </div>

        <div class="col-md-4">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_creating_sparksessions">
          <span class="fa-stack fa-4x">
            <i class="fas fa-circle fa-stack-2x text-primary"></i>
            <i class="fas fas fa-globe fa-stack-1x fa-inverse"></i>
          </span>
          <h4 class="service-heading">Creating SparkSession</h4>
          <p class="text-muted">Setting up a standalone cluster that will parallelize actions across nodes. Also, connecting AWS service S3 for caching data.</p>
          </a>
        </div>
      </div>
    </div>
  </section>

<!-- Installation Setup Modals -->

<!-- Modal Environment Config -->
  <div class="portfolio-modal modal fade" id="portfolioModal_environment_config" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
          <div class="lr">
            <div class="rl"></div>
          </div>
        </div>
        <div class="container">
          <div class="row">
            <div class="col-lg-12 mx-auto">
              <div class="modal-body">
                <!-- Project Details Go Here -->

                <h2 class="text-uppercase">Environment Configuration</h2>
                <p class="item-intro text-muted">Tool Versions, Configure Paths, Dependencies.</p>
                <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                    <a class="navbar-brand" href="#">Navigate</a>
                    <ul class="nav nav-pills">
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                        <div class="dropdown-menu">
                          <a class="dropdown-item" href="#tool_versions">Tool Versions</a>
                          <div role="separator" class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#set_paths">Set Paths</a>
                          <div role="separator" class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#findspark">Findspark</a>
                        </div>
                      </li>
                    </ul>
                  </nav>

                  <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">


                    <h4 id="tool_versions">Tool Versions</h4>
                    <row>
                        <div class="container" id="notebook-container">

                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                            <pre><code>Apache Spark - 2.4.3</code></pre>
                            <pre><code>Jupyter Notebook - 4.4.0</code></pre>
                          </div>
                          </div>
                          </div>
                        </div>
                    </row>




                    <h4 id="set_paths">Set Paths</h4>
                    <row>
                      <div class="container" id="notebook-container">


                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <h5>Configuring ~/.bash_profile</h5>
                        <pre><code>export PATH="/usr/local/bin:$PATH"</code></pre>
                        <pre><code>PATH="/Library/Frameworks/Python.framework/Versions/3.7/bin:${PATH}"</code></pre>
                        <pre><code>export PATH=/usr/local/scala/bin:$PATH</code></pre>
                        <pre><code>export PATH=/usr/local/spark/bin:$PATH</code></pre>
                        <pre><code>export JAVA_HOME=$(/usr/libexec/java_home -v 1.8)</code></pre>
                        <pre><code>export PYSPARK_PYTHON=python3.7</code></pre>
                        <h5>Configuring ~/.bashrc</h5>
                        <pre><code>export PYSPARK_PYTHON=/usr/local/bin/python3.7</code></pre>
                        <pre><code>export PYSPARK_DRIVER_PYTHON=/usr/local/bin/python3.7</code></pre>

                        </div>
                        </div>
                        </div>

                        </div>
                  </row>


                  <h4 id="findspark">Findspark</h4>
                  <row>
                      <div class="container" id="notebook-container">
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Use <code>findspark</code> to be able to find and import <strong>Pyspark</strong> module, while correctly setting environmental variables and dependencies.</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[1]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">traceback</span>
                        <span class="kn">import</span> <span class="nn">findspark</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">findspark</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s1">&#39;/usr/local/spark/&#39;</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_stack</span><span class="p">()))</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Check paths before Executing PySpark Session:</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[2]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
                        <span class="kn">import</span> <span class="nn">sys</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PATH: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">])</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SPARK_HOME: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SPARK_HOME&#39;</span><span class="p">])</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PYSPARK_PYTHON: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYSPARK_PYTHON&#39;</span><span class="p">])</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PYSPARK_DRIVER_PYTHON: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYSPARK_DRIVER_PYTHON&#39;</span><span class="p">])</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>PATH: /Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/spark/bin:/usr/local/scala/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/bin:/usr/local/spark/bin:/usr/local/scala/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/bin:/usr/local/spark/bin:/usr/local/scala/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/bin:/usr/local/spark/bin:/usr/local/scala/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:/usr/local/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin

                        SPARK_HOME: /usr/local/spark/
                        PYSPARK_PYTHON: /usr/local/bin/python3.7
                        PYSPARK_DRIVER_PYTHON: /usr/local/bin/python3.7
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>

                      </div>
                  </row>

                  </div>
<!-- END SCROLLSPY -->



                <button class="btn btn-primary" data-dismiss="modal" type="button">
                  <i class="fas fa-times"></i>
                  Close</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


<!-- Modal Python Packages -->
  <div class="portfolio-modal modal fade" id="portfolioModal_python_packages" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
          <div class="lr">
            <div class="rl"></div>
          </div>
        </div>
        <div class="container">
          <div class="row">
            <div class="col-lg-12 mx-auto">
              <div class="modal-body">
                <!-- Project Details Go Here -->

                <h2 class="text-uppercase">Python Packages</h2>
                <p class="item-intro text-muted">Loading some useful prebuilt Libraries for Python.</p>
                <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                    <a class="navbar-brand" href="#">Navigate</a>
                    <ul class="nav nav-pills">
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                        <div class="dropdown-menu">
                          <a class="dropdown-item" href="#loading_packages">Loading Packages</a>
                          <div role="separator" class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#package_versions">Package Versions</a>
                        </div>
                      </li>
                    </ul>
                  </nav>

                  <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">


                    <h4 id="loading_packages">Loading Packages</h4>
                    <row>
                        <div class="container" id="notebook-container">

                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[3]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#import libraries</span>
                          <span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="k">import</span> <span class="n">SparkSession</span>
                          <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
                          <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
                          <span class="kn">import</span> <span class="nn">matplotlib</span>
                          <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
                          <span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pylab</span>
                          <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
                          <span class="kn">import</span> <span class="nn">subprocess</span>
                          <span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="k">import</span> <span class="o">*</span>
                          <span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">reduce</span>
                          <span class="kn">from</span> <span class="nn">pyspark.ml.feature</span> <span class="k">import</span> <span class="n">StringIndexer</span>
                          <span class="kn">from</span> <span class="nn">pyspark.ml.feature</span> <span class="k">import</span> <span class="n">OneHotEncoderEstimator</span>
                          <span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="k">import</span> <span class="n">DoubleType</span>
                          <span class="kn">from</span> <span class="nn">pyspark.ml</span> <span class="k">import</span> <span class="n">Pipeline</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          </div>
                        </div>
                    </row>




                    <h4 id="package_versions">Package Versions</h4>
                    <row>
                      <div class="container" id="notebook-container">
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[4]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pandas: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numpy: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matplotlib: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;seaborn: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Python: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">))</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>pandas: 0.24.2
                        numpy: 1.16.3
                        matplotlib: 3.0.3
                        seaborn: 0.9.0
                        Python: 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 16:52:21)
                        [Clang 6.0 (clang-600.0.57)]
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>



                        </div>
                  </row>

                  </div>
<!-- END SCROLLSPY -->



                <button class="btn btn-primary" data-dismiss="modal" type="button">
                  <i class="fas fa-times"></i>
                  Close</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


<!-- Modal Creating SparkSession -->
  <div class="portfolio-modal modal fade" id="portfolioModal_creating_sparksessions" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
          <div class="lr">
            <div class="rl"></div>
          </div>
        </div>
        <div class="container">
          <div class="row">
            <div class="col-lg-12 mx-auto">
              <div class="modal-body">
                <!-- Project Details Go Here -->

                <h2 class="text-uppercase">Creating SparkSession</h2>
                <p class="item-intro text-muted">Configure Hadoop for AWS S3, Build SparkSession cluster for work ditribuiton.</p>
                <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                    <a class="navbar-brand" href="#">Navigate</a>
                    <ul class="nav nav-pills">
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                        <div class="dropdown-menu">
                          <a class="dropdown-item" href="#connect_hadoop">Connect to Hadoop</a>
                          <div role="separator" class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#create_session">Create Session</a>
                        </div>
                      </li>
                    </ul>
                  </nav>

                  <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">


                    <h4 id="connect_hadoop">Connect to Hadoop</h4>
                    <row>
                        <div class="container" id="notebook-container">
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Get package to handle AWS to access S3:</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[5]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">set_env</span> PYSPARK_SUBMIT_ARGS=--packages=org.apache.hadoop:hadoop-aws:2.7.3 pyspark-shell
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>env: PYSPARK_SUBMIT_ARGS=--packages=org.apache.hadoop:hadoop-aws:2.7.3 pyspark-shell
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>



                        </div>
                    </row>


                    <h4 id="create_session">Create Session</h4>
                    <row>
                      <div class="container" id="notebook-container">
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Creating Spark Session, hosted across all local nodes on a <strong>Standalone Cluster</strong>:</p>

                        </div>
                        </div>
                        </div>

                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[6]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span> \
                            <span class="o">.</span><span class="n">builder</span> \
                            <span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="s2">&quot;local[*]&quot;</span><span class="p">)</span> \
                            <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;PySpark Craigslist&quot;</span><span class="p">)</span> \
                            <span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;spark.some.config.option&quot;</span><span class="p">,</span> <span class="s2">&quot;some-value&quot;</span><span class="p">)</span> \
                            <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

                        <span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>

                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Configure Hadoop connection for S3:</p>

                        </div>
                        </div>
                        </div>

                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[7]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">hadoopConf</span><span class="o">=</span><span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">_jsc</span><span class="o">.</span><span class="n">hadoopConfiguration</span><span class="p">()</span>
                        <span class="n">hadoopConf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;fs.s3a.access.key&quot;</span><span class="p">,</span> <span class="s2">&quot;AWS_ACCESS_KEY_ID&quot;</span><span class="p">)</span>
                        <span class="n">hadoopConf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;fs.s3a.secret.key&quot;</span><span class="p">,</span> <span class="s2">&quot;AWS_SECRET_ACCESS_KEY&quot;</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>

                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Monitoring Spark instrumentation through the WebUI available through <code>localhost:4040/</code></p>

                        </div>
                        </div>
                        </div>

                        </div>
                  </row>

                  </div>
  <!-- END SCROLLSPY -->



                <button class="btn btn-primary" data-dismiss="modal" type="button">
                  <i class="fas fa-times"></i>
                  Close</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- Extract Stage -->
  <section class="page-section" id="extract">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">Extract Stage</h2>
          <h3 class="section-subheading text-muted">Downloading and Preparing Raw Data for Feature Engineering.</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_raw_data">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/rawdata.jpg" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Raw Data</h4>
            <p class="text-muted">Getting and Validating Data</p>
          </div>
        </div>



        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_basic_data_cleaning">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/basicdatacleaning.jpg" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Data Cleaning</h4>
            <p class="text-muted">Basic Extract Cleaning</p>
          </div>
        </div>
        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_extract_caching_data">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/extractcache.png" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Amazon S3</h4>
            <p class="text-muted">Cache Data on the Cloud</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Extract Stage Modals -->

  <!-- Modal Raw Data -->
    <div class="portfolio-modal modal fade" id="portfolioModal_raw_data" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="close-modal" data-dismiss="modal">
            <div class="lr">
              <div class="rl"></div>
            </div>
          </div>
          <div class="container">
            <div class="row">
              <div class="col-lg-12 mx-auto">
                <div class="modal-body">
                  <!-- Project Details Go Here -->

                  <h2 class="text-uppercase">Raw Data</h2>
                  <p class="item-intro text-muted">Getting and Validating Data.</p>
                  <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                      <a class="navbar-brand" href="#">Navigate</a>
                      <ul class="nav nav-pills">
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                          <div class="dropdown-menu">
                            <a class="dropdown-item" href="#download">Download</a>
                            <div role="separator" class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#validate_data">Validate Data</a>
                          </div>
                        </li>
                      </ul>
                    </nav>

                    <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">


                      <h4 id="download">Download Kaggle Dataset</h4>
                      <row>
                          <div class="container" id="notebook-container">
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                              <p>Available from <a href="https://www.kaggle.com/austinreese/craigslist-carstrucks-data">kaggle.com/austinreese/</a></p>
                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[8]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;../data/craigslistVehiclesFull.csv&quot;</span><span class="p">)</span>
                            <span class="nb">type</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="p">)</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt output_prompt">Out[8]:</div>




                            <div class="output_text output_subarea output_execute_result">
                            <pre>pyspark.sql.dataframe.DataFrame</pre>
                            </div>

                            </div>

                            </div>
                            </div>

                            </div>

                          </div>
                      </row>




                      <h4 id="validate_data">Validate Data</h4>
                      <row>
                        <div class="container" id="notebook-container">
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Now that the data is available as a local <em>dataframe</em> on the Spark cluster, let's validate the dataframe by look at the schema, size, samples and statistics of our working data -</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[9]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>root
                           |-- url: string (nullable = true)
                           |-- city: string (nullable = true)
                           |-- price: string (nullable = true)
                           |-- year: string (nullable = true)
                           |-- manufacturer: string (nullable = true)
                           |-- make: string (nullable = true)
                           |-- condition: string (nullable = true)
                           |-- cylinders: string (nullable = true)
                           |-- fuel: string (nullable = true)
                           |-- odometer: string (nullable = true)
                           |-- title_status: string (nullable = true)
                           |-- transmission: string (nullable = true)
                           |-- vin: string (nullable = true)
                           |-- drive: string (nullable = true)
                           |-- size: string (nullable = true)
                           |-- type: string (nullable = true)
                           |-- paint_color: string (nullable = true)
                           |-- image_url: string (nullable = true)
                           |-- lat: string (nullable = true)
                           |-- long: string (nullable = true)
                           |-- county_fips: string (nullable = true)
                           |-- county_name: string (nullable = true)
                           |-- state_fips: string (nullable = true)
                           |-- state_code: string (nullable = true)
                           |-- state_name: string (nullable = true)
                           |-- weather: string (nullable = true)

                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Dimensions of Raw Dataset:</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[10]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>1723065 26
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Collecting random sample to see what kind of data populates each column:</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[11]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt output_prompt">Out[11]:</div>



                          <div class="output_html rendered_html output_subarea output_execute_result">
                          <div>
                          <style scoped>
                              .dataframe tbody tr th:only-of-type {
                                  vertical-align: middle;
                              }

                              .dataframe tbody tr th {
                                  vertical-align: top;
                              }

                              .dataframe thead th {
                                  text-align: right;
                              }
                          </style>
                          <table border="1" class="dataframe">
                            <thead>
                              <tr style="text-align: right;">
                                <th></th>
                                <th>url</th>
                                <th>city</th>
                                <th>price</th>
                                <th>year</th>
                                <th>manufacturer</th>
                                <th>make</th>
                                <th>condition</th>
                                <th>cylinders</th>
                                <th>fuel</th>
                                <th>odometer</th>
                                <th>...</th>
                                <th>paint_color</th>
                                <th>image_url</th>
                                <th>lat</th>
                                <th>long</th>
                                <th>county_fips</th>
                                <th>county_name</th>
                                <th>state_fips</th>
                                <th>state_code</th>
                                <th>state_name</th>
                                <th>weather</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th>13</th>
                                <td>https://charlestonwv.craigslist.org/ctd/d/2007...</td>
                                <td>charlestonwv</td>
                                <td>25500</td>
                                <td>2007</td>
                                <td>ram</td>
                                <td>3500 crewcab slt 4x4 d</td>
                                <td>None</td>
                                <td>None</td>
                                <td>diesel</td>
                                <td>113284</td>
                                <td>...</td>
                                <td>white</td>
                                <td>https://images.craigslist.org/00g0g_bHJB1JbXtf...</td>
                                <td>39.4991</td>
                                <td>-76.9101</td>
                                <td>24013</td>
                                <td>Carroll</td>
                                <td>24</td>
                                <td>MD</td>
                                <td>Maryland</td>
                                <td>56</td>
                              </tr>
                              <tr>
                                <th>29</th>
                                <td>https://kelowna.craigslist.ca/ctd/d/2019-gmc-3...</td>
                                <td>kelowna</td>
                                <td>85475</td>
                                <td>2019</td>
                                <td>gmc</td>
                                <td>sierra 3500hd</td>
                                <td>new</td>
                                <td>8 cylinders</td>
                                <td>diesel</td>
                                <td>None</td>
                                <td>...</td>
                                <td>black</td>
                                <td>https://images.craigslist.org/00M0M_9lsAVea6hZ...</td>
                                <td>49.130744</td>
                                <td>-123.089055</td>
                                <td>None</td>
                                <td>None</td>
                                <td>None</td>
                                <td>None</td>
                                <td>FAILED</td>
                                <td>None</td>
                              </tr>
                              <tr>
                                <th>20</th>
                                <td>https://providence.craigslist.org/ctd/d/2004-t...</td>
                                <td>providence</td>
                                <td>3900</td>
                                <td>2004</td>
                                <td>toyota</td>
                                <td>tacoma</td>
                                <td>excellent</td>
                                <td>4 cylinders</td>
                                <td>gas</td>
                                <td>196513</td>
                                <td>...</td>
                                <td>red</td>
                                <td>https://images.craigslist.org/00101_12fzkUv3ni...</td>
                                <td>42.3509</td>
                                <td>-71.5434</td>
                                <td>25017</td>
                                <td>Middlesex</td>
                                <td>25</td>
                                <td>MA</td>
                                <td>Massachusetts</td>
                                <td>50</td>
                              </tr>
                              <tr>
                                <th>106</th>
                                <td>https://waco.craigslist.org/ctd/d/2014-buick-e...</td>
                                <td>waco</td>
                                <td>16917</td>
                                <td>2014</td>
                                <td>buick</td>
                                <td>enclave</td>
                                <td>None</td>
                                <td>6 cylinders</td>
                                <td>gas</td>
                                <td>100754</td>
                                <td>...</td>
                                <td>white</td>
                                <td>https://images.craigslist.org/00w0w_j7lCv7CT7E...</td>
                                <td>30.2063</td>
                                <td>-97.7956</td>
                                <td>48453</td>
                                <td>Travis</td>
                                <td>48</td>
                                <td>TX</td>
                                <td>Texas</td>
                                <td>67</td>
                              </tr>
                              <tr>
                                <th>63</th>
                                <td>https://inlandempire.craigslist.org/cto/d/1934...</td>
                                <td>inlandempire</td>
                                <td>27500</td>
                                <td>1934</td>
                                <td>ford</td>
                                <td>None</td>
                                <td>None</td>
                                <td>None</td>
                                <td>gas</td>
                                <td>None</td>
                                <td>...</td>
                                <td>None</td>
                                <td>https://images.craigslist.org/00W0W_aZTwTMicJw...</td>
                                <td>34.1426</td>
                                <td>-117.2606</td>
                                <td>6071</td>
                                <td>San Bernardino</td>
                                <td>6</td>
                                <td>CA</td>
                                <td>California</td>
                                <td>59</td>
                              </tr>
                              <tr>
                                <th>49</th>
                                <td>https://harrisburg.craigslist.org/ctd/d/2002-s...</td>
                                <td>harrisburg</td>
                                <td>4200</td>
                                <td>2002</td>
                                <td>subaru</td>
                                <td>impreza sedan wrx</td>
                                <td>None</td>
                                <td>None</td>
                                <td>gas</td>
                                <td>196320</td>
                                <td>...</td>
                                <td>None</td>
                                <td>https://images.craigslist.org/00e0e_cFNZx7PuV4...</td>
                                <td>39.332716</td>
                                <td>-76.443686</td>
                                <td>24005</td>
                                <td>Baltimore</td>
                                <td>24</td>
                                <td>MD</td>
                                <td>Maryland</td>
                                <td>56</td>
                              </tr>
                              <tr>
                                <th>40</th>
                                <td>https://westky.craigslist.org/cto/d/2017-nissa...</td>
                                <td>westky</td>
                                <td>16200</td>
                                <td>2017</td>
                                <td>nissan</td>
                                <td>altima</td>
                                <td>like new</td>
                                <td>4 cylinders</td>
                                <td>gas</td>
                                <td>16000</td>
                                <td>...</td>
                                <td>white</td>
                                <td>https://images.craigslist.org/00z0z_fn7dkNiUlS...</td>
                                <td>36.8621</td>
                                <td>-87.4851</td>
                                <td>21047</td>
                                <td>Christian</td>
                                <td>21</td>
                                <td>KY</td>
                                <td>Kentucky</td>
                                <td>50</td>
                              </tr>
                              <tr>
                                <th>71</th>
                                <td>https://nmi.craigslist.org/cto/d/malibu-maxx-l...</td>
                                <td>nmi</td>
                                <td>1300</td>
                                <td>2004</td>
                                <td>chevrolet</td>
                                <td>malibu ls</td>
                                <td>good</td>
                                <td>6 cylinders</td>
                                <td>gas</td>
                                <td>None</td>
                                <td>...</td>
                                <td>silver</td>
                                <td>https://images.craigslist.org/00n0n_96V5x7sGt8...</td>
                                <td>45.0125</td>
                                <td>-84.6723</td>
                                <td>26137</td>
                                <td>Otsego</td>
                                <td>26</td>
                                <td>MI</td>
                                <td>Michigan</td>
                                <td>45</td>
                              </tr>
                              <tr>
                                <th>21</th>
                                <td>https://memphis.craigslist.org/cto/d/2005-taho...</td>
                                <td>memphis</td>
                                <td>5900</td>
                                <td>2005</td>
                                <td>chevrolet</td>
                                <td>1500 tahoe</td>
                                <td>good</td>
                                <td>8 cylinders</td>
                                <td>gas</td>
                                <td>156000</td>
                                <td>...</td>
                                <td>None</td>
                                <td>https://images.craigslist.org/00O0O_jJvOPJ9AaJ...</td>
                                <td>34.90897</td>
                                <td>-89.691696</td>
                                <td>28093</td>
                                <td>Marshall</td>
                                <td>28</td>
                                <td>MS</td>
                                <td>Mississippi</td>
                                <td>61</td>
                              </tr>
                              <tr>
                                <th>154</th>
                                <td>https://wyoming.craigslist.org/cto/d/1957-chev...</td>
                                <td>wyoming</td>
                                <td>16799</td>
                                <td>1957</td>
                                <td>chevrolet</td>
                                <td>None</td>
                                <td>None</td>
                                <td>None</td>
                                <td>gas</td>
                                <td>None</td>
                                <td>...</td>
                                <td>None</td>
                                <td>https://images.craigslist.org/01313_fVzyx7MyGU...</td>
                                <td>42.8261</td>
                                <td>-106.3896</td>
                                <td>56025</td>
                                <td>Natrona</td>
                                <td>56</td>
                                <td>WY</td>
                                <td>Wyoming</td>
                                <td>41</td>
                              </tr>
                            </tbody>
                          </table>
                          <p>10 rows  26 columns</p>
                          </div>
                          </div>

                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Basic statistics on raw dataset columns:</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[12]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span><span class="s2">&quot;state_code&quot;</span><span class="p">,</span><span class="s2">&quot;year&quot;</span><span class="p">,</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span><span class="s2">&quot;long&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          <span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;manufacturer&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">,</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span><span class="s2">&quot;odometer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          <span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;cylinders&quot;</span><span class="p">,</span><span class="s2">&quot;fuel&quot;</span><span class="p">,</span><span class="s2">&quot;transmission&quot;</span><span class="p">,</span><span class="s2">&quot;drive&quot;</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          <span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span><span class="s2">&quot;title_status&quot;</span><span class="p">,</span><span class="s2">&quot;vin&quot;</span><span class="p">,</span><span class="s2">&quot;paint_color&quot;</span><span class="p">,</span><span class="s2">&quot;image_url&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          <span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;county_fips&quot;</span><span class="p">,</span><span class="s2">&quot;state_fips&quot;</span><span class="p">,</span><span class="s2">&quot;weather&quot;</span><span class="p">,</span><span class="s2">&quot;state_code&quot;</span><span class="p">,</span><span class="s2">&quot;state_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>+-------+----------+------------------+------------------+--------------------+------------------+
                          |summary|      city|        state_code|              year|                 lat|              long|
                          +-------+----------+------------------+------------------+--------------------+------------------+
                          |  count|   1723065|           1664232|           1716750|             1723065|           1723063|
                          |   mean|      null|              28.4|2004.8408405417213|  38.781324850962136|-93.60776402344794|
                          | stddev|      null|11.749231653365442|  12.0877162743775|   5.983397428918304| 67.11417142134626|
                          |    min|abbotsford|                17|              1553|           -0.201001|         -0.072901|
                          |    max|zanesville|                WY|               718|https://images.cr...|              9009|
                          +-------+----------+------------------+------------------+--------------------+------------------+

                          +-------+------------+--------------------+--------------------+---------+------------------+
                          |summary|manufacturer|                make|               price|condition|          odometer|
                          +-------+------------+--------------------+--------------------+---------+------------------+
                          |  count|     1586651|             1653476|             1723065|  1022285|           1159007|
                          |   mean|        null|2.0412982685270864E8|  107554.03791615523|     null|113638.96127165236|
                          | stddev|        null|5.219260906638930...|1.0044387316232303E7|     null| 136861.0463338454|
                          |    min|       acura|        ! ton pickup|                   1|     4x4&#34;|                 0|
                          |    max|          vw|                   |           999999999|  salvage|               gas|
                          +-------+------------+--------------------+--------------------+---------+------------------+

                          +-------+------------+------------------+-----------------+-----------------+-----------+-----------------+
                          |summary|   cylinders|              fuel|     transmission|            drive|       size|             type|
                          +-------+------------+------------------+-----------------+-----------------+-----------+-----------------+
                          |  count|     1031768|           1712702|          1714034|          1061178|     599110|          1020129|
                          |   mean|        null|120491.66666666667|             null|             null|       null|         34.80225|
                          | stddev|        null|44637.820025922716|             null|             null|       null|6.530767520360834|
                          |    min|10 cylinders|            135000|1G2WP52K7XF291710|1GBJK34G05E297566|        4wd|          30.1843|
                          |    max|  parts only|             other|          rebuilt|              rwd|sub-compact|            wagon|
                          +-------+------------+------------------+-----------------+-----------------+-----------+-----------------+

                          +-------+--------------------+-----------------+--------------------+------------------+------------------+
                          |summary|                 url|     title_status|                 vin|       paint_color|         image_url|
                          +-------+--------------------+-----------------+--------------------+------------------+------------------+
                          |  count|             1723065|          1720508|              605345|           1027421|           1723060|
                          |   mean|                null|69335.88888888889|2.329898077722364E15|         -92.24275|      5156.2716049|
                          | stddev|                null|40424.25247127164|1.221077550015922...|0.2730139282161253|10912.512283606751|
                          |    min|https://abbotsfor...|           166730|                 !!!|          -92.0497|             22055|
                          |    max|https://zanesvill...|          salvage|                   |            yellow|             white|
                          +-------+--------------------+-----------------+--------------------+------------------+------------------+

                          +-------+-----------------+------------------+-----------------+------------------+------------------+
                          |summary|      county_fips|        state_fips|          weather|        state_code|        state_name|
                          +-------+-----------------+------------------+-----------------+------------------+------------------+
                          |  count|          1664232|           1664232|          1663629|           1664232|           1723061|
                          |   mean|28430.36144109112| 28.34413681877833| 53.7870443893704|              28.4|54.833333333333336|
                          | stddev|16054.35450578523|16.032296397585032|7.799403370681863|11.749231653365442|2.7141603981096374|
                          |    min|         -117.381|                 1|               29|                17|                51|
                          |    max|          Ventura|              York|       Washington|                WY|           Wyoming|
                          +-------+-----------------+------------------+-----------------+------------------+------------------+

                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Generally, the <code>.describe()</code> or <code>.explain()</code> method is a good way to start exploring a dataset. For this dataset, there are too many columns, some very unclean, and it is hard to decipher much from the above results. <br></p>
                          <p>For this project, we will perform cleaning twice. The Extract stage has a basic cleaning section to remove duplicates and to obtain numerical features (notice in the schema above, all columns are <em>String</em> by default). We can cache the Extracted Data in a compressed format such as parquet, so it can be used for different pipelines. <br></p>
                          <p>The main cleaning section is performed during the <a href="#Transform-Data">Transform Stage</a>.<br></p>

                          </div>
                          </div>
                          </div>




                        </div>
                    </row>

                    </div>
  <!-- END SCROLLSPY -->



                  <button class="btn btn-primary" data-dismiss="modal" type="button">
                    <i class="fas fa-times"></i>
                    Close</button>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


<!-- Modal Basic Data Cleaning -->
    <div class="portfolio-modal modal fade" id="portfolioModal_basic_data_cleaning" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="close-modal" data-dismiss="modal">
            <div class="lr">
              <div class="rl"></div>
            </div>
          </div>
          <div class="container">
            <div class="row">
              <div class="col-lg-12 mx-auto">
                <div class="modal-body">
                  <!-- Project Details Go Here -->

                  <h2 class="text-uppercase">Data Cleaning</h2>
                  <p class="item-intro text-muted">Basic Cleaning during the Extract Stage.</p>
                  <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                      <a class="navbar-brand" href="#">Navigate</a>
                      <ul class="nav nav-pills">
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                          <div class="dropdown-menu">
                            <a class="dropdown-item" href="#removing_duplicates">Removing Duplicates</a>
                            <div role="separator" class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#numerical_columns">Numerical Columns</a>
                          </div>
                        </li>
                      </ul>
                    </nav>

                    <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">

                      <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                      </div><div class="inner_cell">
                      <div class="text_cell_render border-box-sizing rendered_html">
                      <p>The goal of <strong>Extract Stage</strong> cleaning is to find a balance between cleaning the data and maintaining the maximum amount of raw data. This optimizes usability for other pipelines. <br></p>

                      </div>
                      </div>
                      </div>

                      <h4 id="removing_duplicates">Removing Duplicates</h4>
                      <row>
                          <div class="container" id="notebook-container">

                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>The raw dataset was obtained using a scraper from Craiglist. This means that each post will have a unique url.</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[13]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>1723065
                            1723065
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>The scraper can't find duplicate recors because of various reasons. Each duplicate is more likely the result of people posting multiple times or other errors. Therefore no record from the raw dataset can be found to be a complete duplicate.</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>However, duplicates can be removed by excluding <code>url</code> when calling .drop_duplicates() on <strong><code>vehicle_listings</code></strong>.</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[14]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>[&#39;url&#39;, &#39;city&#39;, &#39;price&#39;, &#39;year&#39;, &#39;manufacturer&#39;, &#39;make&#39;, &#39;condition&#39;, &#39;cylinders&#39;, &#39;fuel&#39;, &#39;odometer&#39;, &#39;title_status&#39;, &#39;transmission&#39;, &#39;vin&#39;, &#39;drive&#39;, &#39;size&#39;, &#39;type&#39;, &#39;paint_color&#39;, &#39;image_url&#39;, &#39;lat&#39;, &#39;long&#39;, &#39;county_fips&#39;, &#39;county_name&#39;, &#39;state_fips&#39;, &#39;state_code&#39;, &#39;state_name&#39;, &#39;weather&#39;]
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[15]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">=</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">,</span> <span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;cylinders&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">,</span> <span class="s1">&#39;odometer&#39;</span><span class="p">,</span> <span class="s1">&#39;title_status&#39;</span><span class="p">,</span> <span class="s1">&#39;transmission&#39;</span><span class="p">,</span> <span class="s1">&#39;vin&#39;</span><span class="p">,</span> <span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;paint_color&#39;</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">,</span> <span class="s1">&#39;county_fips&#39;</span><span class="p">,</span> <span class="s1">&#39;county_name&#39;</span><span class="p">,</span> <span class="s1">&#39;state_fips&#39;</span><span class="p">,</span> <span class="s1">&#39;state_code&#39;</span><span class="p">,</span> <span class="s1">&#39;state_name&#39;</span><span class="p">,</span> <span class="s1">&#39;weather&#39;</span><span class="p">])</span>

                            </pre></div>

                                </div>
                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[16]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">old_col</span><span class="o">=</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                            <span class="n">old_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                            <span class="n">new_col</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                            <span class="n">new_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Dimensions - &quot;</span><span class="p">,</span><span class="n">old_col</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="n">old_row</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Dimensions - &quot;</span><span class="p">,</span><span class="n">new_col</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="n">new_row</span><span class="p">)</span>


                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data kept through Extract: </span><span class="si">%d</span><span class="s2"> percent of records</span><span class="se">\n</span><span class="s2">-----------------&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">new_col</span> <span class="o">/</span> <span class="n">old_col</span><span class="p">))</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>Original Dimensions -  1723065 * 26
                            New Dimensions -  1537438 * 26
                            Data kept through Extract: 89 percent of records
                            -----------------
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>



                          </div>
                      </row>




                      <h4 id="numerical_columns">Numerical Columns</h4>
                      <row>
                        <div class="container" id="notebook-container">

                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Convert <em>numerical feature types</em> from string to float to obtain <strong>Numerical</strong> data columns.</p>

                          </div>
                          </div>
                          </div>


                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[17]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;year&quot;</span><span class="p">,</span><span class="s2">&quot;odometer&quot;</span><span class="p">]</span>

                          <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="p">(</span><span class="n">reduce</span><span class="p">(</span>
                                      <span class="k">lambda</span> <span class="n">memo_df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">:</span> <span class="n">memo_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="n">vehicle_listings</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)),</span>
                                      <span class="n">cols</span><span class="p">,</span>
                                      <span class="n">vehicle_listings_clean</span><span class="p">))</span>

                          <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>root
                           |-- url: string (nullable = true)
                           |-- city: string (nullable = true)
                           |-- price: float (nullable = true)
                           |-- year: float (nullable = true)
                           |-- manufacturer: string (nullable = true)
                           |-- make: string (nullable = true)
                           |-- condition: string (nullable = true)
                           |-- cylinders: string (nullable = true)
                           |-- fuel: string (nullable = true)
                           |-- odometer: float (nullable = true)
                           |-- title_status: string (nullable = true)
                           |-- transmission: string (nullable = true)
                           |-- vin: string (nullable = true)
                           |-- drive: string (nullable = true)
                           |-- size: string (nullable = true)
                           |-- type: string (nullable = true)
                           |-- paint_color: string (nullable = true)
                           |-- image_url: string (nullable = true)
                           |-- lat: string (nullable = true)
                           |-- long: string (nullable = true)
                           |-- county_fips: string (nullable = true)
                           |-- county_name: string (nullable = true)
                           |-- state_fips: string (nullable = true)
                           |-- state_code: string (nullable = true)
                           |-- state_name: string (nullable = true)
                           |-- weather: string (nullable = true)

                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>



                          </div>
                    </row>

                    </div>
  <!-- END SCROLLSPY -->



                  <button class="btn btn-primary" data-dismiss="modal" type="button">
                    <i class="fas fa-times"></i>
                    Close</button>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


<!-- Modal Extract Caching Data -->
    <div class="portfolio-modal modal fade" id="portfolioModal_extract_caching_data" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="close-modal" data-dismiss="modal">
            <div class="lr">
              <div class="rl"></div>
            </div>
          </div>
          <div class="container">
            <div class="row">
              <div class="col-lg-12 mx-auto">
                <div class="modal-body">
                  <!-- Project Details Go Here -->

                  <h2 class="text-uppercase">Amazon S3</h2>
                  <p class="item-intro text-muted">At the end of the Extract Stage, store the new dataset on the cloud. In this case, Amazon S3.</p>
                  <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                      <a class="navbar-brand" href="#">Navigate</a>
                      <ul class="nav nav-pills">
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                          <div class="dropdown-menu">
                            <a class="dropdown-item" href="#cache_data">Cache Data</a>
                          </div>
                        </li>
                      </ul>
                    </nav>

                    <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">
                      <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                      </div><div class="inner_cell">
                      <div class="text_cell_render border-box-sizing rendered_html">
                      <p>After cleaning, the final task in the <strong>Extract</strong> stage is to cache the data. I will store the cleaned dataset as a parquet file on Amazon S3. We can return to this file without having to run the Extract pipeline again, and attach other pipelines from this point as well. <br></p>

                      </div>
                      </div>
                      </div>
                      <h4 id="cache_data">Cache Data on S3</h4>
                      <row>
                          <div class="container" id="notebook-container">

                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <div class="alert alert-warning">
                            <b>NOTE</b> This implementation uses .coalesce(4) before .write() to optimize read/write performance on S3.
                            </div>
                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[18]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#vehicle_listings_clean.write.parquet(&quot;s3a://deveshetl/usedcars/extract&quot;,mode=&quot;overwrite&quot;)</span>
                            <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;../data/vehicle_listings_extract.parquet&quot;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Unable to connect to S3 directly using SparkSession due to Spark generating its credentials, possibly due to versioning... <br>
                            Instead, we can connect to S3 using a bash script.<br>
                            The parquet compression brings the file size down to <em>&lt;30MB</em>, so this doesn't cause performance issues here.<br></p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[19]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Connecting to AWS S3...&quot;</span><span class="p">)</span>
                            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;./S3_connect.command&#39;</span><span class="p">,</span><span class="s1">&#39;write_extract&#39;</span><span class="p">])</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Object Written to S3.&quot;</span><span class="p">)</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>Connecting to AWS S3...
                            Object Written to S3.
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>This completes the <strong>Extract Stage</strong>. <br></p>
                            <p>We clean, sample and explore the data in the <strong>Transform Stage</strong>. The data available on S3 is clean but as close to the raw data as possible. <br></p>

                            </div>
                            </div>
                            </div>





                          </div>
                      </row>

                    </div>
  <!-- END SCROLLSPY -->



                  <button class="btn btn-primary" data-dismiss="modal" type="button">
                    <i class="fas fa-times"></i>
                    Close</button>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>







  <!-- Transform Stage -->
  <div id="transform"></div>
  <section class="bg-light page-section" id="extract">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">Transform Stage</h2>
          <h3 class="section-subheading text-muted">The Core Stage of any pipeline. Here, the data is heavily cleaned and feature engineered for Machine Learning capabilities.</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_data_cleaning">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/datacleaning.jpg" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Data Cleaning</h4>
            <p class="text-muted">Thoroughly cleaning data, to optimize features.</p>
          </div>
        </div>
        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_feature_engineering">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/features.png" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Feature Engineering</h4>
            <p class="text-muted">Preparing the Data for Machine Learning</p>
          </div>
        </div>
        <div class="col-md-4 col-sm-6 portfolio-item">
          <a class="portfolio-link" data-toggle="modal" href="#portfolioModal_exploratory_data_analysis">
            <div class="portfolio-hover">
              <div class="portfolio-hover-content">
                <i class="fas fa-plus fa-3x"></i>
              </div>
            </div>
            <img class="img-fluid" src="img/portfolio/visualize.png" alt="">
          </a>
          <div class="portfolio-caption">
            <h4>Exploratory Data Analysis</h4>
            <p class="text-muted">Sampling and Visualization using Pandas</p>
          </div>
        </div>

      </div>
    </div>
  </section>




<!-- Modal Data Cleaning -->
      <div class="portfolio-modal modal fade" id="portfolioModal_data_cleaning" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
              <div class="lr">
                <div class="rl"></div>
              </div>
            </div>
            <div class="container">
              <div class="row">
                <div class="col-lg-12 mx-auto">
                  <div class="modal-body">
                    <!-- Project Details Go Here -->

                    <h2 class="text-uppercase">Data Cleaning</h2>
                    <p class="item-intro text-muted">Main Cleaning Stage</p>
                    <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                        <a class="navbar-brand" href="#">Navigate</a>
                        <ul class="nav nav-pills">
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="#general">General</a>
                              <div role="separator" class="dropdown-divider"></div>
                              <a class="dropdown-item" href="#numerical_columns2">Numerical Columns</a>
                              <div role="separator" class="dropdown-divider"></div>
                              <a class="dropdown-item" href="#ordinal_columns">Ordinal Columns</a>
                              <div role="separator" class="dropdown-divider"></div>
                              <a class="dropdown-item" href="#categorical_columns">Categorical Columns</a>
                            </div>
                          </li>
                        </ul>
                      </nav>

                      <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">

                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>The goal of this <strong>Cleaning Phase</strong>, unlike the previous one, is to eliminate all data
                          that is either redundant or harmful to analysis. <br></p>

                        </div>
                        </div>
                        </div>

                        <h4 id="general">General Cleaning</h4>
                        <row>
                            <div class="container" id="notebook-container">

                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p><em>First we obtain the working dataset from the cached source on S3.</em> <br></p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[20]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Connecting to AWS S3...&quot;</span><span class="p">)</span>
                              <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;./S3_connect.command&#39;</span><span class="p">,</span><span class="s1">&#39;read_extract&#39;</span><span class="p">])</span>
                              <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Object Read from S3 to ../data.&quot;</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>Connecting to AWS S3...
                              Object Read from S3 to ../data.
                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[21]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#vehicles_listings_read=spark.read.parquet(&quot;s3a://s3://deveshetl/usedcars/extract&quot;)</span>
                              <span class="c1">#vehicle_listings_read=spark.read.parquet(&quot;../data/vehicle_listings_read.parquet&quot;)</span>

                              <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;inferschema&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;../data/vehicle_listings_read_extract.parquet&quot;</span><span class="p">)</span>
                              <span class="nb">type</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[21]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>pyspark.sql.dataframe.DataFrame</pre>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[22]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>1537438 26
                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>There are over 1.5 million records, and 26 columns. The dataset is too large to perform EDA (Exploratory Data Analysis) comfortably. <br>
                              The final data after <em>Cleaning</em> should be as clean as possible without redundant data.<br></p>

                              </div>
                              </div>
                              </div>

                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>Cleaning is essential during the <strong>Transform Stage</strong> of the ETL pipeline. The main goal here is to optimize the dataset for the endgoal of the project - Creating a machine learning pipeline to predict the target varibale <strong>Price</strong>. <br></p>
                              <p>We can also cache the cleaned data set before sampling and exploration for other machine learning project using the same dataset.<br></p>

                              </div>
                              </div>
                              </div>



                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <h3 id="Cleaning-Checkpoints">Cleaning Checkpoints</h3><ul>
                              <li>General<ul>
                              <li>Drop Columns</li>
                              <li>Drop Rows (Null Price)</li>
                              </ul>
                              </li>
                              <li>Numerical <ul>
                              <li>Apply Reasonable Ranges<ul>
                              <li>Kept Odometer Null Values</li>
                              </ul>
                              </li>
                              </ul>
                              </li>
                              <li>Ordinal<ul>
                              <li>Narrow down relevant options</li>
                              <li>Remove errors in columns</li>
                              <li>Keep countable ordinal values</li>
                              </ul>
                              </li>
                              <li>Categorical<ul>
                              <li>State_code + State_name (Extract Stage)<ul>
                              <li>Removed State_name</li>
                              </ul>
                              </li>
                              </ul>
                              </li>
                              </ul>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <h4 id="Drop-Columns">Drop Columns</h4><p>Some Columns are redundant, we can remove them before moving forward.<br></p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[23]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="s1">&#39;vin&#39;</span><span class="p">,</span> <span class="s1">&#39;paint_color&#39;</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">,</span> \
                                                                     <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">,</span> <span class="s1">&#39;county_fips&#39;</span><span class="p">,</span> <span class="s1">&#39;state_fips&#39;</span><span class="p">,</span><span class="s1">&#39;weather&#39;</span><span class="p">)</span>
                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Remaining columns-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>Remaining columns- [&#39;city&#39;, &#39;price&#39;, &#39;year&#39;, &#39;manufacturer&#39;, &#39;make&#39;, &#39;condition&#39;, &#39;cylinders&#39;, &#39;fuel&#39;, &#39;odometer&#39;, &#39;title_status&#39;, &#39;transmission&#39;, &#39;drive&#39;, &#39;size&#39;, &#39;type&#39;, &#39;county_name&#39;, &#39;state_code&#39;, &#39;state_name&#39;]
                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>'lat' and 'long' provide no more useful information than ('city','county_name', 'state_code', 'state_name'), and are therefore not needed.<br>
                              The other dropped columns are not helpful to the analysis.</p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>The remaining attribute characteristics are varied, we have three types of features available in our data -
                              <strong>Numerical</strong>, <strong>Ordinal</strong>, <strong>Categorical</strong><br></p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p><strong>Potential Column Types -</strong> <br>
                              Numerical - price, year, odometer <br>
                              Ordinal - condition, cylinders, fuel, title_status, transmission, drive, size, type <br>
                              Categorical - city, manufacturer, make, county_name, state_code, state_name <br></p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>The target variable of this project is <strong>Price</strong>. Therefore, any records where price is null would be irrelevant. Check to see if the dataset contains null prices.</p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[24]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[24]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>0</pre>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>

                            </div>
                        </row>




                        <h4 id="numerical_columns2">Numerical Columns</h4>
                        <row>
                          <div class="container" id="notebook-container">

                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[25]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">basics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;manufacturer&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">,</span><span class="s2">&quot;city&quot;</span><span class="p">,</span><span class="s2">&quot;odometer&quot;</span><span class="p">,</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
                            <span class="c1">#Smaller subset to take quick look at records</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <h4 id="Applying-a-Reasonable-Range-on-Continuous-Types">Applying a Reasonable Range on Continuous Types</h4>
                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Website postings that advertise items for sale often manipulate search algorithms to get more hits. For example, thousands of posts are spammed with a price of $1 (minimum allowed), to get more visibility through the 'search by price' filter. To ensure that our working dataset is within reasonable boundaries, we apply restrictions on the <em>Continuous</em> data columns.</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[26]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too new: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;year &gt;= 2019&quot;).count())
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too old: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;year &lt; 1930&quot;).count())
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too expensive: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;price &gt; 300000&quot;).count())
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too cheap: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;price &lt; 50&quot;).count())
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too many miles: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;odometer &gt; 250000&quot;).count())
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too few miles: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">vehicle_listings_clean</span>.where(&quot;odometer &lt; 50&quot;).count())
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>Too new: 2571
                            Too old: 2187
                            Too expensive: 824
                            Too cheap: 20299
                            Too many miles: 27155
                            Too few miles: 9989
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Before removing 20k+ records due to price, let's confirm if the spame hypothesis is true:</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[27]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;price&lt;50&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">basics</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>+-----+------------+--------------------+------------+--------+------+
                            |price|manufacturer|                make|        city|odometer|  year|
                            +-----+------------+--------------------+------------+--------+------+
                            |  4.0|        ford|            f150 4x4|     buffalo|    null|1977.0|
                            |  1.0|        ford|              bronco|    greenbay|    null|1995.0|
                            | 20.0|         gmc|             topkick|jacksonville|    null|1995.0|
                            | 11.0|     hyundai|  genesis coupe 2.0t|     kelowna|    null|2010.0|
                            |  1.0|       honda|               s2000|    columbia|    null|2001.0|
                            | 11.0|  volkswagen|              routan|   charlotte| 64256.0|2013.0|
                            |  1.0|       dodge|            1500 slt|   brunswick|    null|2004.0|
                            |  1.0|        ford|f-150 xlt superca...|    annarbor|177000.0|2007.0|
                            |  1.0|       honda|              accord|   allentown|    null|1997.0|
                            |  1.0|        ford|              ranger|   tricities|    null|2002.0|
                            |  1.0|      nissan|              murano|       tampa| 41847.0|2016.0|
                            |  1.0|         kia|           soul 2.0l|       fayar| 32000.0|2014.0|
                            |  1.0|       chevy|              malibu|  youngstown|    null|2011.0|
                            |  1.0|        ford|           expeditio|oklahomacity|    null|2000.0|
                            |  1.0|      toyota|               camry|     visalia|    null|1987.0|
                            |  4.0|   chevrolet|              impala|  sacramento|    null|2007.0|
                            |  1.0|         gmc| sierra 1500 classic|      mobile|    null|2007.0|
                            | 10.0|        jeep|                cj-7|       ocala|120000.0|1977.0|
                            |  1.0|        ford|            f150 4x4| southjersey|200000.0|2000.0|
                            | 39.0|       honda|              accord|  neworleans|    null|2010.0|
                            +-----+------------+--------------------+------------+--------+------+
                            only showing top 20 rows

                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>As expected, these randomly obtained results show us that "price&lt;50" is not very useful to the study. <br></p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[28]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Null odometer - &quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">odometer</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Null price - &quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Null year - &quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isNull</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>Null odometer -  517952
                            Null price -  0
                            Null year -  5817
                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>The Null counts shows us that a lot of listings have not reported Odometer values, perhaps to increase chances of selling a car or maybe due to lack of info. The question is, do we remove all these records altogether?<br>
                            I would rather keep these records because the 50k+ rows will still provide useful information about other attributes. Removing these values would reduce the dataset by 35%, which is too high.<br>
                            <br>Apply the restrictions to vehicle_listings_clean.<br>
                            Note- The Spark environment allows me to use a direct SQL query to restrict odometer values. This is better suited because the <strong><code>pyspark.sql.dataframe</code></strong> library treats "null" values as false when evaluating the <code>.where()</code> function.</p>

                            </div>
                            </div>
                            </div>
                            <div class="cell border-box-sizing code_cell rendered">
                            <div class="input">
                            <div class="prompt input_prompt">In&nbsp;[29]:</div>
                            <div class="inner_cell">
                                <div class="input_area">
                            <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;price&gt;=50 and price&lt;=300000&quot;</span><span class="p">)</span> \
                                                <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;year&gt;=1930 and year&lt;2019&quot;</span><span class="p">)</span> \
                                                <span class="c1">#.where(&quot;odometer&lt;=350000&quot;)</span>
                                                <span class="c1">#.where(vehicle_listings_clean.odometer.isNull()) \</span>

                            <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">registerTempTable</span><span class="p">(</span><span class="s2">&quot;df_temp&quot;</span><span class="p">)</span>

                            <span class="n">vehicle_listings_clean</span><span class="o">=</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM df_temp WHERE (odometer&gt;=50 AND odometer&lt;=250000) OR (odometer IS NULL)&quot;</span><span class="p">)</span>



                            <span class="sd">&#39;&#39;&#39;</span>
                            <span class="sd">Other implementation - </span>
                            <span class="sd">Replace null with value such as &quot;not_reported&quot;. </span>
                            <span class="sd">Problem - Odometer then can&#39;t be treated as continuous data.</span>
                            <span class="sd">&#39;&#39;&#39;</span>

                            <span class="n">org</span><span class="o">=</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                            <span class="n">new</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------</span><span class="se">\n</span><span class="s2">Original No. of Records - &quot;</span><span class="p">,</span><span class="n">org</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Within Reasonable Range - &quot;</span><span class="p">,</span><span class="n">new</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data kept for analysis: </span><span class="si">%d</span><span class="s2"> percent of records</span><span class="se">\n</span><span class="s2">-----------------&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">new</span> <span class="o">/</span> <span class="n">org</span><span class="p">))</span>


                            <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;year&quot;</span><span class="p">,</span><span class="s2">&quot;odometer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                            </pre></div>

                                </div>
                            </div>
                            </div>

                            <div class="output_wrapper">
                            <div class="output">


                            <div class="output_area">

                                <div class="prompt"></div>


                            <div class="output_subarea output_stream output_stdout output_text">
                            <pre>-----------------
                            Original No. of Records -  1723065
                            Within Reasonable Range -  1470500
                            Data kept for analysis: 85 percent of records
                            -----------------
                            +-------+------------------+------------------+------------------+
                            |summary|             price|              year|          odometer|
                            +-------+------------------+------------------+------------------+
                            |  count|           1470500|           1470500|            970988|
                            |   mean|10841.028629037743|2004.8051193471608|106333.99521209324|
                            | stddev|11492.387883154905|11.587408041215316| 59834.98816437917|
                            |    min|              50.0|            1930.0|              50.0|
                            |    max|          300000.0|            2018.0|          250000.0|
                            +-------+------------------+------------------+------------------+

                            </pre>
                            </div>
                            </div>

                            </div>
                            </div>

                            </div>
                            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                            </div><div class="inner_cell">
                            <div class="text_cell_render border-box-sizing rendered_html">
                            <p>Although only 3 attributes, <strong>price, year, odometer</strong>, can be directly converted to numerical value, other attributes can be be transformed to fit the Categorical and Ordinal labels. The difference between categorical and ordinal values is that ordinal values have a clear and restricted ordering of types. For example, <em>'condition'</em> would be ordinal, ranging from excellent to poor.</p>

                            </div>
                            </div>
                            </div>

                          </div>
                      </row>




                      <h4 id="ordinal_columns">Ordinal Columns</h4>
                      <row>
                        <div class="container" id="notebook-container">


                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Ordinal data will play an important role in learning about price. An ordinal data type is a variable that has a limited number of options, which can be ordered. For example, <code>"condition"</code> should range from excellent to bad (or in this case, "salvage".</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>The following columns are of the <strong>Ordinal</strong> types -  <br>
                          (condition, cylinders, fuel, title_status, transmission, drive, size, type) <br></p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p><strong><code>ordinals_options_all</code></strong> is a map linking each ordinal to each distinct value provided for it. This will help cleaning the dataset faster.</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[30]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">ordinals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;cylinders&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">,</span> <span class="s1">&#39;title_status&#39;</span><span class="p">,</span> <span class="s1">&#39;transmission&#39;</span><span class="p">,</span> <span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]</span>
                          <span class="n">ordinals_options_all</span><span class="o">=</span><span class="p">{}</span>
                          <span class="c1">#ordinals_options_all[ordinal]=[x[ordinal] for x in vehicle_listings_clean.select(ordinal).distinct().collect()]</span>
                          <span class="k">for</span> <span class="n">ordinal</span> <span class="ow">in</span> <span class="n">ordinals</span><span class="p">:</span>
                              <span class="n">ordinals_options_all</span><span class="p">[</span><span class="n">ordinal</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">ordinal</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">ordinal</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()]))</span>
                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distinct &quot;</span><span class="p">,</span><span class="n">ordinal</span><span class="p">,</span><span class="s2">&quot; options-&quot;</span><span class="p">,</span> <span class="n">ordinals_options_all</span><span class="p">[</span><span class="n">ordinal</span><span class="p">])</span>
                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------&quot;</span><span class="p">)</span>


                          <span class="c1">#Used filter(None,list) because we are only replacing wrong values here, not empty value</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Distinct  condition  options- [&#39;new&#39;, &#39; 84.9&#34;&#34; ca wt&#34;&#39;, &#39; 59.5&#34;&#34; ca lt2&#34;&#39;, &#39; 84.9&#34;&#34; ca 4wd ls&#34;&#39;, &#39; 4x4&#34;&#39;, &#39; auto&#34;&#39;, &#39;excellent&#39;, &#39;6 cylinders&#39;, &#39;audio controls&#34;&#39;, &#39;salvage&#39;, &#39;like new&#39;, &#39;good&#39;, &#39; 84.0&#34;&#34; ca c5b&#34;&#39;, &#39;fair&#39;, &#39;&#34;,,&#34;6 cylinders&#34;&#39;]
                          -----------------
                          Distinct  cylinders  options- [&#39;gas&#39;, &#39;3 cylinders&#39;, &#39;other&#39;, &#39;diesel&#39;, &#39;10 cylinders&#39;, &#39;6 cylinders&#39;, &#39;clean&#39;, &#39;4 cylinders&#39;, &#39;12 cylinders&#39;, &#39;good&#39;, &#39;5 cylinders&#39;, &#39;8 cylinders&#39;, &#39;parts only&#39;]
                          -----------------
                          Distinct  fuel  options- [&#39;gas&#39;, &#39;automatic&#39;, &#39;other&#39;, &#39;diesel&#39;, &#39;135000&#39;, &#39;178000&#39;, &#39;74180&#39;, &#39;hybrid&#39;, &#39;4 cylinders&#39;, &#39;138000&#39;, &#39;8 cylinders&#39;, &#39;59770&#39;, &#39;electric&#39;]
                          -----------------
                          Distinct  title_status  options- [&#39;43742&#39;, &#39;automatic&#39;, &#39;45483&#39;, &#39;lien&#39;, &#39;44001&#39;, &#39;166730&#39;, &#39;missing&#39;, &#39;manual&#39;, &#39;clean&#39;, &#39;salvage&#39;, &#39;60664&#39;, &#39;rebuilt&#39;, &#39;parts only&#39;, &#39;98333&#39;]
                          -----------------
                          Distinct  transmission  options- [&#39;automatic&#39;, &#39;other&#39;, &#39;manual&#39;, &#39;clean&#39;, &#39;rebuilt&#39;, &#39;1G2WP52K7XF291710&#39;]
                          -----------------
                          Distinct  drive  options- [&#39;compact&#39;, &#39;full-size&#39;, &#39;fwd&#39;, &#39;1GDJC34U85E329724&#39;, &#39;rwd&#39;, &#39;1GCEK14VX2Z244409&#39;, &#39;3GBKC34G72M110010&#39;, &#39;4wd&#39;, &#39;1GBJK39608E216926&#39;, &#39;1GBJK34G05E297566&#39;]
                          -----------------
                          Distinct  size  options- [&#39;mini-van&#39;, &#39;compact&#39;, &#39;full-size&#39;, &#39;SUV&#39;, &#39;fwd&#39;, &#39;rwd&#39;, &#39;mid-size&#39;, &#39;https://images.craigslist.org/00k0k_9EJzf6hJHYQ_600x450.jpg&#39;, &#39;sedan&#39;, &#39;pickup&#39;, &#39;https://images.craigslist.org/00606_kBUK1UvzUnA_600x450.jpg&#39;, &#39;sub-compact&#39;, &#39;4wd&#39;]
                          -----------------
                          Distinct  type  options- [&#39;van&#39;, &#39;mini-van&#39;, &#39;offroad&#39;, &#39;grey&#39;, &#39;compact&#39;, &#39;wagon&#39;, &#39;full-size&#39;, &#39;coupe&#39;, &#39;bus&#39;, &#39;39.4202&#39;, &#39;SUV&#39;, &#39;other&#39;, &#39;convertible&#39;, &#39;30.1843&#39;, &#39;sedan&#39;, &#39;hatchback&#39;, &#39;black&#39;, &#39;truck&#39;, &#39;pickup&#39;, &#39;blue&#39;]
                          -----------------
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>As expected, all 8 Ordinal columns have values that seem to be errors, or reported incorrectly. For example, let's look into the "Condition" reported as 'audio controls"'.</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[31]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;condition = &#39;audio controls</span><span class="se">\&quot;</span><span class="s2">&#39;&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">basics</span><span class="o">+</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>+------+------------+------------------+-----------+--------+------+---------------+
                          | price|manufacturer|              make|       city|odometer|  year|      condition|
                          +------+------------+------------------+-----------+--------+------+---------------+
                          |2600.0|        null|&#34;18&#34;&#34; Chrome Alloy|lakecharles|    null|2012.0|audio controls&#34;|
                          +------+------------+------------------+-----------+--------+------+---------------+

                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Only 1 record fetched.</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>The next task is to clean these misleading values for each of the ordinal types. Automating this process, at the very least requires two <code>pyspark.sql.dataframe</code> library calls for each distinct ordinal option - <code>count()</code> and <code>replace()</code>. We can count the number of occurences of a value in an ordinal column, if it's less than 10 then it is  irrelevant and will be grouped under "other".</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p><strong><code>remove_fakes()</code></strong> is a function that takes in a column and all distinct values within the column, and evaluates which options are useful. It bunches up other options under "Other".</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>Time Cost - Each call to <strong><code>remove_fakes()</code></strong> will take <strong>O(n)</strong> <em>(O(2n+1))</em> where <em>n</em> is the length of the column. Because the algorithm needs to call both <code>count()</code> and <code>replace()</code> for any ordinal/value combination, this is the fastest way to clean the ordinal columns.</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[32]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_fakes</span><span class="p">(</span><span class="n">column</span><span class="p">,</span><span class="n">all_options</span><span class="p">):</span>
                              <span class="k">global</span> <span class="n">vehicle_listings_clean</span>
                              <span class="n">kept_options</span><span class="o">=</span><span class="p">[]</span>
                              <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">all_options</span><span class="p">:</span>
                                  <span class="n">option_condition</span> <span class="o">=</span> <span class="n">column</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">option</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
                                  <span class="n">temp_count</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">option_condition</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                                  <span class="k">if</span> <span class="n">temp_count</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
                                      <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">na</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">option</span><span class="p">,</span><span class="s1">&#39;other&#39;</span><span class="p">,</span><span class="n">column</span><span class="p">)</span>
                                      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Removed &quot;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="s2">&quot; from &quot;</span><span class="p">,</span><span class="n">column</span><span class="p">)</span>
                                  <span class="k">else</span><span class="p">:</span>
                                      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kept &quot;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="s2">&quot; from &quot;</span><span class="p">,</span><span class="n">column</span><span class="p">)</span>
                                      <span class="n">kept_options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kept values &quot;</span><span class="p">,</span><span class="n">kept_options</span><span class="p">,</span><span class="s2">&quot; from column &quot;</span><span class="p">,</span><span class="n">column</span><span class="p">)</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <p>The above function does not count <em>null</em> values. The difference between values printed as a list after the clean versus the final <code>count()</code> value are <em>null</em> and, in some cases, <em>other</em>.</p>

                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'condition'">Cleaning column = 'condition'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[33]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#ordinals=[&#39;condition&#39;, &#39;cylinders&#39;, &#39;fuel&#39;, &#39;title_status&#39;, &#39;transmission&#39;, &#39;drive&#39;, &#39;size&#39;, &#39;type&#39;]</span>

                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;condition&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;condition&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;condition&#39;- 16
                          Kept  new  from  condition
                          Removed   84.9&#34;&#34; ca wt&#34;  from  condition
                          Removed   59.5&#34;&#34; ca lt2&#34;  from  condition
                          Removed   84.9&#34;&#34; ca 4wd ls&#34;  from  condition
                          Removed   4x4&#34;  from  condition
                          Removed   auto&#34;  from  condition
                          Kept  excellent  from  condition
                          Removed  6 cylinders  from  condition
                          Removed  audio controls&#34;  from  condition
                          Kept  salvage  from  condition
                          Kept  like new  from  condition
                          Kept  good  from  condition
                          Removed   84.0&#34;&#34; ca c5b&#34;  from  condition
                          Kept  fair  from  condition
                          Removed  &#34;,,&#34;6 cylinders&#34;  from  condition
                          Kept values  [&#39;new&#39;, &#39;excellent&#39;, &#39;salvage&#39;, &#39;like new&#39;, &#39;good&#39;, &#39;fair&#39;]  from column  condition
                          Number for &#39;condition&#39;- 8
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'cylinders'">Cleaning column = 'cylinders'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[34]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;cylinders&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;cylinders&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;cylinders&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;cylinders&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;cylinders&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;cylinders&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;cylinders&#39;- 14
                          Removed  gas  from  cylinders
                          Kept  3 cylinders  from  cylinders
                          Kept  other  from  cylinders
                          Removed  diesel  from  cylinders
                          Kept  10 cylinders  from  cylinders
                          Kept  6 cylinders  from  cylinders
                          Removed  clean  from  cylinders
                          Kept  4 cylinders  from  cylinders
                          Kept  12 cylinders  from  cylinders
                          Removed  good  from  cylinders
                          Kept  5 cylinders  from  cylinders
                          Kept  8 cylinders  from  cylinders
                          Removed  parts only  from  cylinders
                          Kept values  [&#39;3 cylinders&#39;, &#39;other&#39;, &#39;10 cylinders&#39;, &#39;6 cylinders&#39;, &#39;4 cylinders&#39;, &#39;12 cylinders&#39;, &#39;5 cylinders&#39;, &#39;8 cylinders&#39;]  from column  cylinders
                          Number for &#39;cylinders&#39;- 9
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'fuel'">Cleaning column = 'fuel'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[35]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;fuel&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;fuel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;fuel&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;fuel&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;fuel&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;fuel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;fuel&#39;- 14
                          Kept  gas  from  fuel
                          Removed  automatic  from  fuel
                          Kept  other  from  fuel
                          Kept  diesel  from  fuel
                          Removed  135000  from  fuel
                          Removed  178000  from  fuel
                          Removed  74180  from  fuel
                          Kept  hybrid  from  fuel
                          Removed  4 cylinders  from  fuel
                          Removed  138000  from  fuel
                          Removed  8 cylinders  from  fuel
                          Removed  59770  from  fuel
                          Kept  electric  from  fuel
                          Kept values  [&#39;gas&#39;, &#39;other&#39;, &#39;diesel&#39;, &#39;hybrid&#39;, &#39;electric&#39;]  from column  fuel
                          Number for &#39;fuel&#39;- 6
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'title_status'">Cleaning column = 'title_status'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[36]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;title_status&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;title_status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;title_status&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;title_status&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;title_status&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;title_status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;title_status&#39;- 15
                          Removed  43742  from  title_status
                          Removed  automatic  from  title_status
                          Removed  45483  from  title_status
                          Kept  lien  from  title_status
                          Removed  44001  from  title_status
                          Removed  166730  from  title_status
                          Kept  missing  from  title_status
                          Removed  manual  from  title_status
                          Kept  clean  from  title_status
                          Kept  salvage  from  title_status
                          Removed  60664  from  title_status
                          Kept  rebuilt  from  title_status
                          Kept  parts only  from  title_status
                          Removed  98333  from  title_status
                          Kept values  [&#39;lien&#39;, &#39;missing&#39;, &#39;clean&#39;, &#39;salvage&#39;, &#39;rebuilt&#39;, &#39;parts only&#39;]  from column  title_status
                          Number for &#39;title_status&#39;- 8
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'transmission'">Cleaning column = 'transmission'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[37]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;transmission&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;transmission&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;transmission&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;transmission&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;transmission&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;transmission&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;transmission&#39;- 7
                          Kept  automatic  from  transmission
                          Kept  other  from  transmission
                          Kept  manual  from  transmission
                          Removed  clean  from  transmission
                          Removed  rebuilt  from  transmission
                          Removed  1G2WP52K7XF291710  from  transmission
                          Kept values  [&#39;automatic&#39;, &#39;other&#39;, &#39;manual&#39;]  from column  transmission
                          Number for &#39;transmission&#39;- 4
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'drive'">Cleaning column = 'drive'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[38]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;drive&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;drive&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;drive&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;drive&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;drive&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;drive&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;drive&#39;- 11
                          Removed  compact  from  drive
                          Removed  full-size  from  drive
                          Kept  fwd  from  drive
                          Removed  1GDJC34U85E329724  from  drive
                          Kept  rwd  from  drive
                          Removed  1GCEK14VX2Z244409  from  drive
                          Removed  3GBKC34G72M110010  from  drive
                          Kept  4wd  from  drive
                          Removed  1GBJK39608E216926  from  drive
                          Removed  1GBJK34G05E297566  from  drive
                          Kept values  [&#39;fwd&#39;, &#39;rwd&#39;, &#39;4wd&#39;]  from column  drive
                          Number for &#39;drive&#39;- 5
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'size'">Cleaning column = 'size'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[39]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;size&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;size&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;size&#39;- 14
                          Removed  mini-van  from  size
                          Kept  compact  from  size
                          Kept  full-size  from  size
                          Removed  SUV  from  size
                          Removed  fwd  from  size
                          Removed  rwd  from  size
                          Kept  mid-size  from  size
                          Removed  https://images.craigslist.org/00k0k_9EJzf6hJHYQ_600x450.jpg  from  size
                          Removed  sedan  from  size
                          Removed  pickup  from  size
                          Removed  https://images.craigslist.org/00606_kBUK1UvzUnA_600x450.jpg  from  size
                          Kept  sub-compact  from  size
                          Removed  4wd  from  size
                          Kept values  [&#39;compact&#39;, &#39;full-size&#39;, &#39;mid-size&#39;, &#39;sub-compact&#39;]  from column  size
                          Number for &#39;size&#39;- 6
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>
                          <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                          </div><div class="inner_cell">
                          <div class="text_cell_render border-box-sizing rendered_html">
                          <h4 id="Cleaning-column-=-'type'">Cleaning column = 'type'</h4>
                          </div>
                          </div>
                          </div>
                          <div class="cell border-box-sizing code_cell rendered">
                          <div class="input">
                          <div class="prompt input_prompt">In&nbsp;[40]:</div>
                          <div class="inner_cell">
                              <div class="input_area">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;type&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          <span class="n">remove_fakes</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="n">ordinals_options_all</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>
                          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number for &#39;type&#39;-&quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                          </pre></div>

                              </div>
                          </div>
                          </div>

                          <div class="output_wrapper">
                          <div class="output">


                          <div class="output_area">

                              <div class="prompt"></div>


                          <div class="output_subarea output_stream output_stdout output_text">
                          <pre>Number for &#39;type&#39;- 21
                          Kept  van  from  type
                          Kept  mini-van  from  type
                          Kept  offroad  from  type
                          Removed  grey  from  type
                          Removed  compact  from  type
                          Kept  wagon  from  type
                          Removed  full-size  from  type
                          Kept  coupe  from  type
                          Kept  bus  from  type
                          Removed  39.4202  from  type
                          Kept  SUV  from  type
                          Kept  other  from  type
                          Kept  convertible  from  type
                          Removed  30.1843  from  type
                          Kept  sedan  from  type
                          Kept  hatchback  from  type
                          Removed  black  from  type
                          Kept  truck  from  type
                          Kept  pickup  from  type
                          Removed  blue  from  type
                          Kept values  [&#39;van&#39;, &#39;mini-van&#39;, &#39;offroad&#39;, &#39;wagon&#39;, &#39;coupe&#39;, &#39;bus&#39;, &#39;SUV&#39;, &#39;other&#39;, &#39;convertible&#39;, &#39;sedan&#39;, &#39;hatchback&#39;, &#39;truck&#39;, &#39;pickup&#39;]  from column  type
                          Number for &#39;type&#39;- 14
                          </pre>
                          </div>
                          </div>

                          </div>
                          </div>

                          </div>



                        </div>
                    </row>





                    <h4 id="categorical_columns">Categorical Columns</h4>
                    <row>
                      <div class="container" id="notebook-container">

                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>Categorical - city, manufacturer, make, county_name, state_code, state_name <br></p>
                        <p>During the <strong>Transform</strong> stage, categorical columns will help with <em>Stratified Sampling</em> before beginning with Exploratory Data Analysis...</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>There isn't much cleaning to be done with categorical data. An easy observation is that this set of columns give us insight about location unlike other column types. There might be a way to combine state_code and state_name.</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[41]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span><span class="s2">&quot;county_name&quot;</span><span class="p">,</span><span class="s2">&quot;state_code&quot;</span><span class="p">,</span><span class="s2">&quot;state_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>+--------------+------------+----------+----------+
                        |          city| county_name|state_code|state_name|
                        +--------------+------------+----------+----------+
                        |           kpr|      Benton|        WA|Washington|
                        |     vancouver|        null|      null|    FAILED|
                        |    cincinnati|      Butler|        OH|      Ohio|
                        |fredericksburg|Spotsylvania|        VA|  Virginia|
                        |       nanaimo|        null|      null|    FAILED|
                        |         ocala|      Citrus|        FL|   Florida|
                        |       mcallen|     Hidalgo|        TX|     Texas|
                        |        tucson|        Pima|        AZ|   Arizona|
                        |     newjersey|      Bergen|        NJ|New Jersey|
                        |    janesville|        Rock|        WI| Wisconsin|
                        |        muncie|       Grant|        IN|   Indiana|
                        |     baltimore|     Harford|        MD|  Maryland|
                        |     milwaukee|       Dodge|        WI| Wisconsin|
                        |    louisville|   Jefferson|        KY|  Kentucky|
                        |      monterey|    Monterey|        CA|California|
                        |    terrehaute|        Vigo|        IN|   Indiana|
                        |     eauclaire| Trempealeau|        WI| Wisconsin|
                        |   albuquerque|  Bernalillo|        NM|New Mexico|
                        |       augusta|    Columbia|        GA|   Georgia|
                        |      delaware|        null|      null|    FAILED|
                        +--------------+------------+----------+----------+
                        only showing top 20 rows

                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>We can see that when state_code is <em>null</em>, the matching state_name is <em>Failed</em>. Since the state_name appears to be generated by state_code, there isn't any point in keeping both. Let's remove state_name. Our total columns are now 16.</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[42]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;state_name&#39;</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[43]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Dimensions - &quot;</span><span class="p">,</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Dimensions - &quot;</span><span class="p">,</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>Original Dimensions -  1723065 * 26
                        New Dimensions -  1470500 * 16
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <h4 id="Final-dataset-size:">Final dataset size:</h4>
                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[44]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">old_col</span><span class="o">=</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                        <span class="n">old_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                        <span class="n">new_col</span><span class="o">=</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                        <span class="n">new_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Dimensions - &quot;</span><span class="p">,</span><span class="n">old_col</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="n">old_row</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Dimensions - &quot;</span><span class="p">,</span><span class="n">new_col</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="n">new_row</span><span class="p">)</span>


                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data kept for analysis: </span><span class="si">%d</span><span class="s2"> percent of records</span><span class="se">\n</span><span class="s2">-----------------&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">new_col</span> <span class="o">/</span> <span class="n">old_col</span><span class="p">))</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>Original Dimensions -  1723065 * 26
                        New Dimensions -  1470500 * 16
                        Data kept for analysis: 85 percent of records
                        -----------------
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>The used cars dataset is now cleaned and ready for analysis. We can cache this version on S3.</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[45]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#vehicle_listings_clean.write.parquet(&quot;s3a://deveshetl/usedcars/transform&quot;,mode=&quot;overwrite&quot;)</span>
                        <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;../data/vehicle_listings_transform.parquet&quot;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[46]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Connecting to AWS S3...&quot;</span><span class="p">)</span>
                        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;./S3_connect.command&#39;</span><span class="p">,</span><span class="s1">&#39;write_transform&#39;</span><span class="p">])</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Object Written to S3.&quot;</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>Connecting to AWS S3...
                        Object Written to S3.
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>


                      </div>
                  </row>

                      </div>
    <!-- END SCROLLSPY -->



                    <button class="btn btn-primary" data-dismiss="modal" type="button">
                      <i class="fas fa-times"></i>
                      Close</button>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>





<!-- Modal Feature Engineering -->
      <div class="portfolio-modal modal fade" id="portfolioModal_feature_engineering" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
              <div class="lr">
                <div class="rl"></div>
              </div>
            </div>
            <div class="container">
              <div class="row">
                <div class="col-lg-12 mx-auto">
                  <div class="modal-body">
                    <!-- Project Details Go Here -->

                    <h2 class="text-uppercase">Feature Engineering</h2>
                    <p class="item-intro text-muted">Extracting features from the String Columns, so that Learning Models can understand them.</p>
                    <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                        <a class="navbar-brand" href="#">Navigate</a>
                        <ul class="nav nav-pills">
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="#string_indexer">String Indexer</a>
                              <div role="separator" class="dropdown-divider"></div>
                              <a class="dropdown-item" href="#one_hot_encoding">One Hot Encoding</a>
                            </div>
                          </li>
                        </ul>
                      </nav>

                      <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p><em>First we obtain the working dataset from the cached source on S3.</em> <br></p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[47]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Connecting to AWS S3...&quot;</span><span class="p">)</span>
                        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;./S3_connect.command&#39;</span><span class="p">,</span><span class="s1">&#39;read_transform&#39;</span><span class="p">])</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Object Read from S3 to ../data.&quot;</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>Connecting to AWS S3...
                        Object Read from S3 to ../data.
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[48]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#vehicles_listings_read=spark.read.parquet(&quot;s3a://s3://deveshetl/usedcars/extract&quot;)</span>
                        <span class="c1">#vehicle_listings_read=spark.read.parquet(&quot;../data/vehicle_listings_read.parquet&quot;)</span>

                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;inferschema&quot;</span><span class="p">,</span><span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;../data/vehicle_listings_read_transform.parquet&quot;</span><span class="p">)</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt output_prompt">Out[48]:</div>




                        <div class="output_text output_subarea output_execute_result">
                        <pre>pyspark.sql.dataframe.DataFrame</pre>
                        </div>

                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[49]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>1470500 16
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                        </div><div class="inner_cell">
                        <div class="text_cell_render border-box-sizing rendered_html">
                        <p>In the section, we will obtain features from the ordinal columns, in order to use the information for machine learning.</p>

                        </div>
                        </div>
                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[50]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ordinals</span><span class="p">)</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        <div class="output_wrapper">
                        <div class="output">


                        <div class="output_area">

                            <div class="prompt"></div>


                        <div class="output_subarea output_stream output_stdout output_text">
                        <pre>[&#39;condition&#39;, &#39;cylinders&#39;, &#39;fuel&#39;, &#39;title_status&#39;, &#39;transmission&#39;, &#39;drive&#39;, &#39;size&#39;, &#39;type&#39;]
                        </pre>
                        </div>
                        </div>

                        </div>
                        </div>

                        </div>
                        <div class="cell border-box-sizing code_cell rendered">
                        <div class="input">
                        <div class="prompt input_prompt">In&nbsp;[51]:</div>
                        <div class="inner_cell">
                            <div class="input_area">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;condition&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;cylinders&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;fuel&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;title_status&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;transmission&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;drive&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        <span class="n">vehicle_listings_clean</span> <span class="o">=</span> <span class="n">vehicle_listings_clean</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;other&#39;</span><span class="p">})</span>
                        </pre></div>

                            </div>
                        </div>
                        </div>

                        </div>


                        <h4 id="string_indexer">String Indexer</h4>
                        <row>
                            <div class="container" id="notebook-container">
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                                <p>Using <code>StringIndexer</code>, convert ordinal column names to numerical values. It is import to retain the original columns track which index is assigned to which unique column option.</p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[52]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">indexers</span> <span class="o">=</span> <span class="p">[</span><span class="n">StringIndexer</span><span class="p">(</span><span class="n">inputCol</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">outputCol</span><span class="o">=</span><span class="n">column</span><span class="o">+</span><span class="s2">&quot;_index&quot;</span><span class="p">)</span>\
                                          <span class="o">.</span><span class="n">setHandleInvalid</span><span class="p">(</span><span class="s2">&quot;skip&quot;</span><span class="p">)</span>\
                                          <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">ordinals</span><span class="p">]</span>

                              <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">indexers</span><span class="p">)</span>
                              <span class="n">vehicle_listings_features</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vehicle_listings_clean</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>


                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[9]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings_features</span><span class="o">.</span><span class="n">printSchema</span><span class="p">())</span>
                              <span class="n">vehicle_listings_features</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>root
                               |-- city: string (nullable = true)
                               |-- price: float (nullable = true)
                               |-- year: float (nullable = true)
                               |-- manufacturer: string (nullable = true)
                               |-- make: string (nullable = true)
                               |-- condition: string (nullable = false)
                               |-- cylinders: string (nullable = false)
                               |-- fuel: string (nullable = false)
                               |-- odometer: float (nullable = true)
                               |-- title_status: string (nullable = false)
                               |-- transmission: string (nullable = false)
                               |-- drive: string (nullable = false)
                               |-- size: string (nullable = false)
                               |-- type: string (nullable = false)
                               |-- county_name: string (nullable = true)
                               |-- state_code: string (nullable = true)
                               |-- condition_index: double (nullable = false)
                               |-- cylinders_index: double (nullable = false)
                               |-- fuel_index: double (nullable = false)
                               |-- title_status_index: double (nullable = false)
                               |-- transmission_index: double (nullable = false)
                               |-- drive_index: double (nullable = false)
                               |-- size_index: double (nullable = false)
                               |-- type_index: double (nullable = false)

                              None
                              </pre>
                              </div>
                              </div>

                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[9]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>[Row(city=&#39;stjoseph&#39;, price=20000.0, year=1986.0, manufacturer=&#39;chevrolet&#39;, make=&#39;k10&#39;, condition=&#39;other&#39;, cylinders=&#39;other&#39;, fuel=&#39;gas&#39;, odometer=None, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;other&#39;, type=&#39;other&#39;, county_name=&#39;Cass/Van Buren&#39;, state_code=&#39;MO&#39;, condition_index=0.0, cylinders_index=0.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=0.0, type_index=0.0),
                               Row(city=&#39;modesto&#39;, price=5700.0, year=2015.0, manufacturer=&#39;bmw&#39;, make=None, condition=&#39;other&#39;, cylinders=&#39;other&#39;, fuel=&#39;gas&#39;, odometer=None, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;other&#39;, type=&#39;other&#39;, county_name=&#39;Stanislaus&#39;, state_code=&#39;CA&#39;, condition_index=0.0, cylinders_index=0.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=0.0, type_index=0.0),
                               Row(city=&#39;eastnc&#39;, price=22000.0, year=2008.0, manufacturer=&#39;cadillac&#39;, make=&#39;escalade ext&#39;, condition=&#39;excellent&#39;, cylinders=&#39;8 cylinders&#39;, fuel=&#39;gas&#39;, odometer=84744.0, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;full-size&#39;, type=&#39;SUV&#39;, county_name=&#39;Franklin&#39;, state_code=&#39;NC&#39;, condition_index=1.0, cylinders_index=2.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=1.0, type_index=2.0)]</pre>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[10]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings_features</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_features</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>735888 24
                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>

                            </div>
                </row>




                        <h4 id="one_hot_encoding">One Hot Encoding</h4>
                        <row>
                            <div class="container" id="notebook-container">
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                                <p>Using <code>OneHotEncoderEstimator</code>, we can encode the ordinal column indexes.</p>
                              <p>One-hot encoding maps a categorical feature, represented as a label index, to a binary vector with at most a single one-value indicating the presence of a specific feature value from among the set of all feature values. This encoding allows algorithms which expect continuous features, such as Logistic Regression, to use categorical features.</p>

                              </div>
                              </div>
                              </div>

                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[11]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">ordinals_index</span><span class="o">=</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;_index&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ordinals</span><span class="p">]</span>
                              <span class="n">ordinals_vector</span><span class="o">=</span><span class="p">[(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;_vector&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ordinals_index</span><span class="p">]</span>

                              <span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoderEstimator</span><span class="p">(</span><span class="n">inputCols</span><span class="o">=</span><span class="n">ordinals_index</span><span class="p">,</span>
                                                               <span class="n">outputCols</span><span class="o">=</span><span class="n">ordinals_vector</span><span class="p">)</span><span class="o">.</span><span class="n">setDropLast</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                              <span class="n">model</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vehicle_listings_features</span><span class="p">)</span>
                              <span class="n">vehicle_listings_encoded</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vehicle_listings_features</span><span class="p">)</span>
                              <span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[11]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>[Row(city=&#39;stjoseph&#39;, price=20000.0, year=1986.0, manufacturer=&#39;chevrolet&#39;, make=&#39;k10&#39;, condition=&#39;other&#39;, cylinders=&#39;other&#39;, fuel=&#39;gas&#39;, odometer=None, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;other&#39;, type=&#39;other&#39;, county_name=&#39;Cass/Van Buren&#39;, state_code=&#39;MO&#39;, condition_index=0.0, cylinders_index=0.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=0.0, type_index=0.0, fuel_index_vector=SparseVector(5, {0: 1.0}), cylinders_index_vector=SparseVector(8, {0: 1.0}), type_index_vector=SparseVector(13, {0: 1.0}), drive_index_vector=SparseVector(4, {0: 1.0}), title_status_index_vector=SparseVector(7, {0: 1.0}), transmission_index_vector=SparseVector(3, {0: 1.0}), size_index_vector=SparseVector(5, {0: 1.0}), condition_index_vector=SparseVector(7, {0: 1.0})),
                               Row(city=&#39;modesto&#39;, price=5700.0, year=2015.0, manufacturer=&#39;bmw&#39;, make=None, condition=&#39;other&#39;, cylinders=&#39;other&#39;, fuel=&#39;gas&#39;, odometer=None, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;other&#39;, type=&#39;other&#39;, county_name=&#39;Stanislaus&#39;, state_code=&#39;CA&#39;, condition_index=0.0, cylinders_index=0.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=0.0, type_index=0.0, fuel_index_vector=SparseVector(5, {0: 1.0}), cylinders_index_vector=SparseVector(8, {0: 1.0}), type_index_vector=SparseVector(13, {0: 1.0}), drive_index_vector=SparseVector(4, {0: 1.0}), title_status_index_vector=SparseVector(7, {0: 1.0}), transmission_index_vector=SparseVector(3, {0: 1.0}), size_index_vector=SparseVector(5, {0: 1.0}), condition_index_vector=SparseVector(7, {0: 1.0})),
                               Row(city=&#39;eastnc&#39;, price=22000.0, year=2008.0, manufacturer=&#39;cadillac&#39;, make=&#39;escalade ext&#39;, condition=&#39;excellent&#39;, cylinders=&#39;8 cylinders&#39;, fuel=&#39;gas&#39;, odometer=84744.0, title_status=&#39;clean&#39;, transmission=&#39;automatic&#39;, drive=&#39;other&#39;, size=&#39;full-size&#39;, type=&#39;SUV&#39;, county_name=&#39;Franklin&#39;, state_code=&#39;NC&#39;, condition_index=1.0, cylinders_index=2.0, fuel_index=0.0, title_status_index=0.0, transmission_index=0.0, drive_index=0.0, size_index=1.0, type_index=2.0, fuel_index_vector=SparseVector(5, {0: 1.0}), cylinders_index_vector=SparseVector(8, {2: 1.0}), type_index_vector=SparseVector(13, {2: 1.0}), drive_index_vector=SparseVector(4, {0: 1.0}), title_status_index_vector=SparseVector(7, {0: 1.0}), transmission_index_vector=SparseVector(3, {0: 1.0}), size_index_vector=SparseVector(5, {1: 1.0}), condition_index_vector=SparseVector(7, {1: 1.0}))]</pre>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[12]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>root
                               |-- city: string (nullable = true)
                               |-- price: float (nullable = true)
                               |-- year: float (nullable = true)
                               |-- manufacturer: string (nullable = true)
                               |-- make: string (nullable = true)
                               |-- condition: string (nullable = false)
                               |-- cylinders: string (nullable = false)
                               |-- fuel: string (nullable = false)
                               |-- odometer: float (nullable = true)
                               |-- title_status: string (nullable = false)
                               |-- transmission: string (nullable = false)
                               |-- drive: string (nullable = false)
                               |-- size: string (nullable = false)
                               |-- type: string (nullable = false)
                               |-- county_name: string (nullable = true)
                               |-- state_code: string (nullable = true)
                               |-- condition_index: double (nullable = false)
                               |-- cylinders_index: double (nullable = false)
                               |-- fuel_index: double (nullable = false)
                               |-- title_status_index: double (nullable = false)
                               |-- transmission_index: double (nullable = false)
                               |-- drive_index: double (nullable = false)
                               |-- size_index: double (nullable = false)
                               |-- type_index: double (nullable = false)
                               |-- fuel_index_vector: vector (nullable = true)
                               |-- cylinders_index_vector: vector (nullable = true)
                               |-- type_index_vector: vector (nullable = true)
                               |-- drive_index_vector: vector (nullable = true)
                               |-- title_status_index_vector: vector (nullable = true)
                               |-- transmission_index_vector: vector (nullable = true)
                               |-- size_index_vector: vector (nullable = true)
                               |-- condition_index_vector: vector (nullable = true)

                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[13]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span><span class="nb">len</span><span class="p">(</span><span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>735888 32
                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>


                            </div>
                </row>

    </div>
<!-- END SCROLLSPY -->


              <button class="btn btn-primary" data-dismiss="modal" type="button">
                <i class="fas fa-times"></i>
                Close</button>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>





<!-- Modal Exploratory Data Analysis -->
      <div class="portfolio-modal modal fade" id="portfolioModal_exploratory_data_analysis" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
              <div class="lr">
                <div class="rl"></div>
              </div>
            </div>
            <div class="container">
              <div class="row">
                <div class="col-lg-12 mx-auto">
                  <div class="modal-body">
                    <!-- Project Details Go Here -->

                    <h2 class="text-uppercase">Exploratory Data Analysis</h2>
                    <p class="item-intro text-muted">It is not efficient to to EDA with the entire dataset. Instead, we load a sample onto a
                    Pandas Dataframe.</p>
                    <nav id="navbar-example2" class="navbar sticky-top navbar-dark bg-dark">
                        <a class="navbar-brand" href="#">Navigate</a>
                        <ul class="nav nav-pills">
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Checkpoints</a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="#sampling_data">Sampling Data</a>
                              <div role="separator" class="dropdown-divider"></div>
                              <a class="dropdown-item" href="#visualizing_data">Visualizing Data</a>
                            </div>
                          </li>
                        </ul>
                      </nav>

                      <div data-spy="scroll" data-target="#navbar-example2" data-offset="0">
                        <h4 id="sampling_data">Sampling Data</h4>
                        <row>
                            <div class="container" id="notebook-container">

                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                                <p><br>To explore the dataset for analysis, create a <strong>sample pandas dataframe</strong> from the engineered data:</p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[14]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">eda_df</span><span class="o">=</span><span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                              <p>With a small random sample of the Feature Engineered Data, we can take a look at what we're working with.</p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[15]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">eda_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">63</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[15]:</div>



                              <div class="output_html rendered_html output_subarea output_execute_result">
                              <div>
                              <style scoped>
                                  .dataframe tbody tr th:only-of-type {
                                      vertical-align: middle;
                                  }

                                  .dataframe tbody tr th {
                                      vertical-align: top;
                                  }

                                  .dataframe thead th {
                                      text-align: right;
                                  }
                              </style>
                              <table border="1" class="dataframe">
                                <thead>
                                  <tr style="text-align: right;">
                                    <th></th>
                                    <th>city</th>
                                    <th>price</th>
                                    <th>year</th>
                                    <th>manufacturer</th>
                                    <th>make</th>
                                    <th>condition</th>
                                    <th>cylinders</th>
                                    <th>fuel</th>
                                    <th>odometer</th>
                                    <th>title_status</th>
                                    <th>...</th>
                                    <th>size_index</th>
                                    <th>type_index</th>
                                    <th>fuel_index_vector</th>
                                    <th>cylinders_index_vector</th>
                                    <th>type_index_vector</th>
                                    <th>drive_index_vector</th>
                                    <th>title_status_index_vector</th>
                                    <th>transmission_index_vector</th>
                                    <th>size_index_vector</th>
                                    <th>condition_index_vector</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <th>2</th>
                                    <td>joplin</td>
                                    <td>38000.0</td>
                                    <td>2015.0</td>
                                    <td>dodge</td>
                                    <td>None</td>
                                    <td>like new</td>
                                    <td>other</td>
                                    <td>diesel</td>
                                    <td>NaN</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>0.0</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>476</th>
                                    <td>lincoln</td>
                                    <td>1000.0</td>
                                    <td>2002.0</td>
                                    <td>ford</td>
                                    <td>escort</td>
                                    <td>other</td>
                                    <td>other</td>
                                    <td>gas</td>
                                    <td>NaN</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>0.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>480</th>
                                    <td>gainesville</td>
                                    <td>5500.0</td>
                                    <td>2007.0</td>
                                    <td>None</td>
                                    <td>huyndai sonata</td>
                                    <td>excellent</td>
                                    <td>6 cylinders</td>
                                    <td>gas</td>
                                    <td>107000.0</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>3.0</td>
                                    <td>1.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 0.0, 1.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 1.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>553</th>
                                    <td>boulder</td>
                                    <td>15700.0</td>
                                    <td>2015.0</td>
                                    <td>jeep</td>
                                    <td>renegade</td>
                                    <td>excellent</td>
                                    <td>4 cylinders</td>
                                    <td>gas</td>
                                    <td>29000.0</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>2.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>684</th>
                                    <td>nh</td>
                                    <td>11995.0</td>
                                    <td>2012.0</td>
                                    <td>gmc</td>
                                    <td>acadia</td>
                                    <td>excellent</td>
                                    <td>6 cylinders</td>
                                    <td>gas</td>
                                    <td>92309.0</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>2.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>285</th>
                                    <td>springfieldil</td>
                                    <td>9995.0</td>
                                    <td>2007.0</td>
                                    <td>gmc</td>
                                    <td>1500 sierra</td>
                                    <td>other</td>
                                    <td>other</td>
                                    <td>gas</td>
                                    <td>NaN</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>0.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>112</th>
                                    <td>albuquerque</td>
                                    <td>6995.0</td>
                                    <td>2011.0</td>
                                    <td>toyota</td>
                                    <td>corolla le</td>
                                    <td>excellent</td>
                                    <td>4 cylinders</td>
                                    <td>gas</td>
                                    <td>32000.0</td>
                                    <td>salvage</td>
                                    <td>...</td>
                                    <td>1.0</td>
                                    <td>1.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 0.0, 1.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>268</th>
                                    <td>pueblo</td>
                                    <td>3500.0</td>
                                    <td>2000.0</td>
                                    <td>lexus</td>
                                    <td>rx 300</td>
                                    <td>good</td>
                                    <td>6 cylinders</td>
                                    <td>gas</td>
                                    <td>224000.0</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>2.0</td>
                                    <td>2.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 0.0, 1.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>331</th>
                                    <td>nwct</td>
                                    <td>4000.0</td>
                                    <td>1965.0</td>
                                    <td>ford</td>
                                    <td>ranchero</td>
                                    <td>good</td>
                                    <td>8 cylinders</td>
                                    <td>gas</td>
                                    <td>NaN</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>4.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 0.0, 0.0, 1.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                  <tr>
                                    <th>707</th>
                                    <td>williamsport</td>
                                    <td>3450.0</td>
                                    <td>2004.0</td>
                                    <td>chevy</td>
                                    <td>cavalier</td>
                                    <td>other</td>
                                    <td>4 cylinders</td>
                                    <td>gas</td>
                                    <td>82000.0</td>
                                    <td>clean</td>
                                    <td>...</td>
                                    <td>0.0</td>
                                    <td>5.0</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, ...</td>
                                    <td>(0.0, 0.0, 1.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0)</td>
                                    <td>(1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</td>
                                  </tr>
                                </tbody>
                              </table>
                              <p>10 rows  32 columns</p>
                              </div>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[16]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">eda_df</span><span class="o">.</span><span class="n">dtypes</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[16]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>city                          object
                              price                        float32
                              year                         float32
                              manufacturer                  object
                              make                          object
                              condition                     object
                              cylinders                     object
                              fuel                          object
                              odometer                     float32
                              title_status                  object
                              transmission                  object
                              drive                         object
                              size                          object
                              type                          object
                              county_name                   object
                              state_code                    object
                              condition_index              float64
                              cylinders_index              float64
                              fuel_index                   float64
                              title_status_index           float64
                              transmission_index           float64
                              drive_index                  float64
                              size_index                   float64
                              type_index                   float64
                              fuel_index_vector             object
                              cylinders_index_vector        object
                              type_index_vector             object
                              drive_index_vector            object
                              title_status_index_vector     object
                              transmission_index_vector     object
                              size_index_vector             object
                              condition_index_vector        object
                              dtype: object</pre>
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>


                            </div>
                </row>

                        <h4 id="visualizing_data">Visualizing Data</h4>
                        <row>
                            <div class="container" id="notebook-container">


                              <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
                              </div><div class="inner_cell">
                              <div class="text_cell_render border-box-sizing rendered_html">
                                <p><br>To start the <em>EDA</em>, focus on the target variable, i.e. the variable we want our model to be able to predict - <strong>price</strong></p>

                              </div>
                              </div>
                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[17]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ith_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                                  <span class="k">try</span><span class="p">:</span>
                                      <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                                      <span class="k">return</span> <span class="kc">None</span>

                              <span class="n">ith</span> <span class="o">=</span> <span class="n">udf</span><span class="p">(</span><span class="n">ith_</span><span class="p">,</span> <span class="n">DoubleType</span><span class="p">())</span>

                              <span class="c1">#condition_index_vector</span>


                              <span class="n">encoded</span><span class="o">=</span><span class="n">vehicle_listings_encoded</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_0&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_1&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_2&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_3&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_4&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_5&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;condition_6&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>

                              <span class="n">encoded</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span><span class="s2">&quot;condition_index&quot;</span><span class="p">,</span><span class="s2">&quot;condition_index_vector&quot;</span><span class="p">,</span><span class="s2">&quot;condition_0&quot;</span><span class="p">,</span><span class="s2">&quot;condition_1&quot;</span><span class="p">,</span><span class="s2">&quot;condition_2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>+---------+---------------+----------------------+-----------+-----------+-----------+
                              |condition|condition_index|condition_index_vector|condition_0|condition_1|condition_2|
                              +---------+---------------+----------------------+-----------+-----------+-----------+
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |excellent|            1.0|         (7,[1],[1.0])|        0.0|        1.0|        0.0|
                              | like new|            3.0|         (7,[3],[1.0])|        0.0|        0.0|        0.0|
                              |     good|            2.0|         (7,[2],[1.0])|        0.0|        0.0|        1.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              | like new|            3.0|         (7,[3],[1.0])|        0.0|        0.0|        0.0|
                              |excellent|            1.0|         (7,[1],[1.0])|        0.0|        1.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |     good|            2.0|         (7,[2],[1.0])|        0.0|        0.0|        1.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |     good|            2.0|         (7,[2],[1.0])|        0.0|        0.0|        1.0|
                              |    other|            0.0|         (7,[0],[1.0])|        1.0|        0.0|        0.0|
                              |     good|            2.0|         (7,[2],[1.0])|        0.0|        0.0|        1.0|
                              +---------+---------------+----------------------+-----------+-----------+-----------+
                              only showing top 20 rows

                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[18]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#title_status_index_vector</span>


                              <span class="n">encoded</span><span class="o">=</span><span class="n">encoded</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_0&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_1&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_2&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_3&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_4&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_5&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>\
                              <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;title_status_6&#39;</span><span class="p">,</span> <span class="n">ith</span><span class="p">(</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>

                              <span class="n">encoded</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;title_status&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_index&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_index_vector&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_0&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_1&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt"></div>


                              <div class="output_subarea output_stream output_stdout output_text">
                              <pre>+------------+------------------+-------------------------+--------------+--------------+--------------+
                              |title_status|title_status_index|title_status_index_vector|title_status_0|title_status_1|title_status_2|
                              +------------+------------------+-------------------------+--------------+--------------+--------------+
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |     salvage|               2.0|            (7,[2],[1.0])|           0.0|           0.0|           1.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              |       clean|               0.0|            (7,[0],[1.0])|           1.0|           0.0|           0.0|
                              +------------+------------------+-------------------------+--------------+--------------+--------------+
                              only showing top 20 rows

                              </pre>
                              </div>
                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[19]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_heat</span><span class="o">=</span><span class="n">encoded</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[20]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_heat_condition</span><span class="o">=</span><span class="n">df_heat</span><span class="p">[[</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;condition_0&quot;</span><span class="p">,</span><span class="s2">&quot;condition_1&quot;</span><span class="p">,</span><span class="s2">&quot;condition_2&quot;</span><span class="p">,</span><span class="s2">&quot;condition_3&quot;</span><span class="p">,</span><span class="s2">&quot;condition_4&quot;</span><span class="p">,</span><span class="s2">&quot;condition_5&quot;</span><span class="p">,</span><span class="s2">&quot;condition_6&quot;</span><span class="p">]]</span>
                              <span class="c1">#encoded.select(&quot;price&quot;,&quot;condition_0&quot;,&quot;condition_1&quot;,&quot;condition_2&quot;,&quot;condition_3&quot;,&quot;condition_4&quot;,&quot;condition_5&quot;,&quot;condition_6&quot;).sample(False,0.0001,63).toPandas()</span>

                              <span class="n">matrix</span> <span class="o">=</span> <span class="n">df_heat_condition</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
                              <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
                              <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                              <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Price vs Conditions&#39;</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[20]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>Text(0.5, 1.0, &#39;Price vs Conditions&#39;)</pre>
                              </div>

                              </div>

                              <div class="output_area">

                                  <div class="prompt"></div>




                              <div class="output_png output_subarea ">
                              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmQAAAIRCAYAAADk/qHOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJzs3X3YXWV55/3vrwgWh9oKQaSCBOoLhVagBae8PIoUre1UBAqCogiWxrFF7cxTRKlP27FDh9bjmbbU1poyQIqASIZYrFQsxgAaFTLKi0SwFAMEBI1olWoRcp/zx1qxm9v7Lcm9c2XvfD8c+7jX+zqvnZCcOa9rXStVhSRJktr5kdYBSJIkbetMyCRJkhozIZMkSWrMhEySJKkxEzJJkqTGTMgkSZIaMyGTthFJ/iHJG1rH0VqSFUnO6JdPSfLxGY79f5LcteWik7StMiGTRlSSNUm+l+TRJA8nuTjJTtMdX1W/XFVLtmSMc5Xk6Un+LMl9fXv+uV9fMMz7VtWlVfXygTgqyXMH9t9YVS8YZgySBCZk0qh7ZVXtBPwccDDwrskHpLPV/r+eZAfgE8D+wCuApwOHAt8AXtQwNEnaYrbaP6QlzV1VPQD8A/Az8INuuXOTfBr4LrDPYFddf8xvJPlSku8kWZ3k5/rtP5nkfyf5epKvJHnrVPdM8h+TPJRku4FtxyW5rV9+UZJVSb7dV/D+5zThnwo8BziuqlZX1URVfa2q/rCqrumv9dN9/N9KckeSYwbueXGSv0zy0b4tn0vyUwP7X5bkziT/kuS9QAb2nZbkU/3yDf3mW/sq3UlJjkyyduD4TYqjT4r/NMnX+u/j9iQ/M+0vqKRtjgmZNAaS7An8CvCFgc2vBxYBPwbcO+n4E4E/oEuGng4cA3yjr6R9BLgVeDbwi8BvJ/mlyfesqs8B/wocNbD5tcBl/fKfA39eVU8Hfgr40DThHw18rKoenaZt2/cxfRx4JvAW4NIkg12JJwP/DXgGcDdwbn/uAuAqusrhAuCfgcOnuk9VvbhfPKCqdqqqK+YrDuDlwIuB5wM/DryargIoSYAJmTTqPpzkW8CngOuBPxrYd3FV3VFVT1TV45POOwP4k6q6uTp3V9W9wCHArlX17qr6flXdA/wNXaIxlcuB1wAk+TG6pPDyft/jwHOTLKiqR6vqs9NcYxfgqzO08ReAnYDz+piWA3+/4b69ZVV1U1U9AVwKHNhv/xXgjqpa2n8HfwY8NMO9ZrI5cTxOlxjvC6SqvlRVM7VZ0jbGhEwabcdW1U9U1V5V9ZtV9b2BfffPcN6edNWiyfYCfrLvkvtWn+ydA+w2zXUuA45P8lTgeODzfWIH8Ot0FaE7k9yc5FenucY3gN1niPUngfuramJg2710FbwNBpOs79IlTj84d8OOqipm/l5msslx9Mnbe4G/BL6WZHGSp29iHJLGkAmZNL5qhn3303UjTrX9K32St+HzY1X1K1PeoGo1XVLyyzy5u5Kq+qeqeg1d994fA0uT/IcpLnMd8EvT7AN4ENhz0oMJzwEemKF9G3yVLvkEurFcg+sbaXPioKrOr6qfB/ajS1TP2sQ4JI0hEzJp23QB8DtJfr4fcP7cJHsBNwHfSXJ2kh2TbJfkZ5IcMsO1LgPeRjdG6soNG5O8LsmufUXpW/3miSnOv4QuEfzfSfZN8iNJdklyTpJfAT5HV216e5LtkxwJvBL44Bza+VFg/yTHJ3kK8FbgWTMc/zCwzzT7NjmOJIf0D0FsTzfu7t+Y+ruQtI0yIZO2QVV1Jd2A88uA7wAfBnauqvXAr9KNffoKsI4uefvxGS53OfASYHlVrRvY/grgjiSP0g3wP3lSl+qGWB6jG9h/J/CPwLfpEsMFwOeq6vt0ic8v9/H8FXBqVd05h3auA04EzqPrGn0e8OkZTvkDYEnfXfvqSdfa5DjoHpz4G+CbdBXFbwDvmcN5krYR6YZUSJIkqRUrZJIkSY2ZkEmSpG1Okgv7yZq/OM3+JDk/yd1JbtsweXa/7w1J/qn/zMs7gk3IJEnStuhiurGu0/llunGnz6ObZPt9AEl2Bn4f+I90r3f7/STP2NxgTMgkSdI2p6puAB6Z4ZBXAX/bT579WeAnkuwO/BLwj1X1SFV9k+5hpJkSuzl5yuZeYBvgUw+SpG1JZj9k/jy+7p6h/D27w64/9Sa6ytYGi6tq8UZc4tk8eSLptf226bZvFhOyOXh83T2tQxiK7Rfsw5sXvnr2A0fU+9Z8aGzb97413Wshj9/rmFmOHE1X3Xs1AB951mtmOXI0vfKh7u1SFz37dY0jGY7TH/gA71z42tZhDM3/WHMZr9/r+NZhDMUl917VOoR50ydfG5OANWVCJkmS2plY3zqC6TzAk9/ssUe/7QHgyEnbV2zuzRxDJkmS9MOuBk7tn7b8BeBfquqrwLXAy5M8ox/M//J+22axQiZJktqpNm8RS3I5XaVrQZK1dE9Obg9QVX8NXAP8CnA33WvTTu/3PZLkD4Gb+0u9u6pmejhgTkzIJEnSNqeqZhykWt2rjH5rmn0XAhfOZzwmZJIkqZ2JNhWyrY1jyCRJkhqzQiZJkpqpRmPItjYmZJIkqR27LAG7LCVJkpqzQiZJktqxyxKwQiZJktScFTJJktTO1vvqpC3KhEySJLVjlyVgl6UkSVJzVsgkSVI7TnsBWCGTJElqzgqZJElqxpn6OyZkkiSpHbssAbssJUmSmrNCJkmS2rHLErBCJkmS1JwVMkmS1I4z9QNjViFL8u4kR7eOQ5IkaWOMTYUsyXZV9Xut45AkSRvBMWTAiFTIkixMcmeSS5N8KcnSJE9LsibJHyf5PHBikouTnNCfc0iSlUluTXJTkh9Lsl2S9yS5OcltSd7UuGmSJG3bJiaG8xkxI5GQ9V4A/FVV/TTwbeA3++3fqKqfq6oPbjgwyQ7AFcDbquoA4Gjge8CvA/9SVYcAhwC/kWTvyTdKsijJqiSrFi9ePNxWSZKkbd4odVneX1Wf7pc/ALy1X75iimNfAHy1qm4GqKpvAyR5OfDCDVU04MeB5wFfGTy5qhYDGzKxenzdPfPWCEmSNMAuS2C0ErKaZv1fN+IaAd5SVdfOT0iSJEmbb5S6LJ+T5NB++bXAp2Y49i5g9ySHAPTjx54CXAu8Ocn2/fbnJ/kPwwxakiTNwDFkwGhVyO4CfivJhcBq4H3AW6Y6sKq+n+Qk4C+S7Eg3fuxo4AJgIfD5JAG+Dhy7BWKXJElTqHIeMhithOyJqnrdpG0LB1eq6rSB5ZuBX5jiOuf0H0mSpK3CKCVkkiRp3DioHxiRhKyq1gA/0zoOSZKkYRiJhEySJI2pERyAPwwmZJIkqR27LIHRmvZCkiRpLFkhkyRJ7Uw47QVYIZMkSWrOCpkkSWrHMWSAFTJJkqTmrJBJkqR2nPYCMCGTJEkt2WUJ2GUpSZLUnBUySZLUjl2WgBUySZKk5qyQSZKkdqyQASZkkiSpoSpn6ge7LCVJkpqzQiZJktqxyxKwQiZJktScFTJJktSOE8MCJmSSJKkluywBSFW1jmFr5xckSdqWZEve7HufWDyUv2d3/MVFW7Qdm8sK2Ry8eeGrW4cwFO9b8yEeX3dP6zCGZvsF+/CMnZ7bOoyh+OajdwPwlB2e3TiS4Xji+w8AcMCzDmscyXDc+tBKAA599ksbRzIcn3ngk7xur+NbhzE0H7j3Ko7f65jWYQzFVfdeveVvapcl4KB+SZKk5qyQSZKkdhxDBlghkyRJas4KmSRJascxZIAJmSRJaskuS8AuS0mSpOaskEmSpHaskAFWyCRJkpqzQiZJktpxUD9gQiZJklqyyxKwy1KSJKk5K2SSJKkduywBK2SSJEnNWSGTJEntOIYMMCGTJEkt2WUJ2GUpSZLUnBUySZLUjl2WgBUySZKk5qyQSZKkdhpVyJK8AvhzYDvggqo6b9L+PwVe2q8+DXhmVf1Ev289cHu/776qOmZz4zEhkyRJ25Qk2wF/CbwMWAvcnOTqqlq94Ziq+i8Dx78FOGjgEt+rqgPnMya7LCVJUjtVw/nM7EXA3VV1T1V9H/gg8KoZjn8NcPk8tXhKJmSSJKmdiYmhfJIsSrJq4LNo4K7PBu4fWF/bb/shSfYC9gaWD2z+0f6an01y7Hx8DXZZSpKksVNVi4HF83Cpk4GlVbV+YNteVfVAkn2A5Ulur6p/3pybmJBJkqR22gzqfwDYc2B9j37bVE4GfmtwQ1U90P+8J8kKuvFlm5WQNemyTHJxkhP65QuS7NcvnzPpuJXzfN+9k3wuyd1Jrkiyw3xeX5IkjYSbgef1ecEOdEnX1ZMPSrIv8AzgMwPbnpHkqf3yAuBwYPXkczdW8zFkVXXGwFMN50zad9g83+6PgT+tqucC3wR+fZ6vL0mSNkZNDOcz0y2rngDOBK4FvgR8qKruSPLuJINTWJwMfLDqSU8J/DSwKsmtwCeB8wafztxUc+qyTHIq8DtAAbcB/x9wIbAA+DpwelXdl+Ri4NvAwcCzgLdX1dIkAf6C7vHS+4HvD1x7RX/tE4Adk9wC3FFVpyR5tKp26s//E+CX+xj+e1VdkeRI4A+AdcDPAP8HeN2kL27DfQIcBby237SkP/d9Uxy7CFgE8P73v38uX5EkSdoUjeYhq6prgGsmbfu9Set/MMV5K4Gfne94Zk3IkuwPvAs4rKrWJdmZLplZUlVLkrwROB/Y8JTB7sARwL505b+lwHHAC4D9gN3oSnsXDt6nqt6R5Mxp5vU4HjgQOIAuCbw5yQ39voOA/YEHgU/TlQ4/NcU1dgG+1WfFMMMTFZMGAtab/+i6qQ6TJEmaF3PpsjwKuLKq1gFU1SPAocBl/f5L6BKwDT5cVRN9+W63ftuLgcuran1VPciTHx2diyMGzn8YuB44pN93U1WtraoJ4BZg4UZeW5IktdJmHrKtzjDGkD02sJwhXH+m+61n+qrfN4CfSLJh/0xPVEiSJG0xc0nIlgMnJtkFoO+yXEk30A3gFODGWa5xA3BSku2S7M6/vxtqsseTbD/F9hsHzt+VruJ20xxi/4F+XNkn6caqAbwB+LuNuYYkSZpnQ5oYdtTMOoasf+rgXOD6/mWaXwDeAlyU5Cz6Qf2zXGYZXdfnauA+Bh4fnWQxcFuSz1fVKZPOPxS4lW5Q/9ur6qH+cdSNcTbwwST/vW/H/9rI8yVJ0nwaweRpGOb0lGVVLaEbyD/oqCmOO23S+k79z6J7vHSqax85sHw2XdI01fln9Z/Bc1cAKwbWp7zHwP576N5fJUmStNVwpn5JktTOLHOGbSvGMiFLsozuRaCDzq6qa1vEI0mSNJOxTMiq6rjWMUiSpNnVxOhNUTEMzV+dJEmStK0bywqZJEkaET5lCZiQSZKklhzUD9hlKUmS1JwVMkmS1I6D+gErZJIkSc1ZIZMkSe04qB8wIZMkSS2ZkAF2WUqSJDVnhUySJLVTDuoHK2SSJEnNWSGTJEntOIYMMCGTJEktOQ8ZYJelJElSc1bIJElSO77LErBCJkmS1FzKx01n4xckSdqWZEve7Lt/fPpQ/p592tkXbdF2bC4rZJIkSY05hmwO3rzw1a1DGIr3rfkQz9jpua3DGJpvPno3j6+7p3UYQ7H9gn0AeP6uBzeOZDi+/PVVALx8z1c0jmQ4Pn7/xwD41ef8p8aRDMff3/dRzlh4QuswhuaCNUt5/V7Htw5jKC6596otfs9y2gvAhEySJLXktBeAXZaSJEnNWSGTJEntOO0FYIVMkiSpOStkkiSpHceQASZkkiSpJZ+yBOyylCRJas4KmSRJascuS8AKmSRJUnNWyCRJUjtOewGYkEmSpJbssgTsspQkSWrOCpkkSWrGl4t3rJBJkiQ1ZoVMkiS14xgywAqZJElSc1bIJElSO1bIABMySZLUkvOQAXZZSpIkNWeFTJIktWOXJWCFTJIkqTkrZJIkqZmyQgaYkEmSpJZMyIBGXZZJLk5yQr98QZL9+uVzJh23cp7ve2aSu5NUkgXzeW1JkqRN1XwMWVWdUVWr+9VzJu07bJ5v92ngaODeeb6uJEnaFBMTw/mMmDklZElOTXJbkluTXJJkYZLl/bZPJHlOf9zFSc5PsjLJPQNVsCR5b5K7klwHPHPg2iuSHJzkPGDHJLckubTf9+jA+e9J8sUktyc5qd9+ZH/+0iR3Jrk0SaZrR1V9oarWzKG9i5KsSrJq8eLFc/mKJEmSNtmsY8iS7A+8CzisqtYl2RlYAiypqiVJ3gicDxzbn7I7cASwL3A1sBQ4DngBsB+wG7AauHDwPlX1jiRnVtWBU4RxPHAgcACwALg5yQ39voOA/YEH6SpghwOfmlvzp1ZVi4ENmVi9+Y+u25zLSZKk6TiGDJhbhewo4MqqWgdQVY8AhwKX9fsvoUvANvhwVU303ZC79dteDFxeVeur6kFg+UbGecTA+Q8D1wOH9Ptuqqq1VTUB3AIs3MhrS5KkViZqOJ8RM4wxZI8NLE/bfTik+63HJ0clSdKImUtCthw4MckuAH2X5Urg5H7/KcCNs1zjBuCkJNsl2R146TTHPZ5k+ym23zhw/q50Fbeb5hC7JEnailXVUD6jZtaErKruAM4Frk9yK/A/gbcApye5DXg98LZZLrMM+Ce6sWN/C3xmmuMWA7dtGNQ/6fzbgFvpEsS3V9VDs8U+WZK3JlkL7NHf54KNvYYkSdJ8m1P3XlUtoRvIP+ioKY47bdL6Tv3PAs6c5tpHDiyfDZw9zfln9Z/Bc1cAKwbWp7zHwP7z6R5AkCRJW4MRHO81DI63kiRJ7ZiQAWOakCVZBuw9afPZVXVti3gkSZJmMpYJWVUd1zoGSZI0O18u3mn+6iRJkqRt3VhWyCRJ0oiwQgZYIZMkSWrOCpkkSWpnonUAWwcrZJIkqZmaqKF8ZpPkFUnuSnJ3kndMsf+0JF9Pckv/OWNg3xuS/FP/ecN8fA9WyCRJ0jYlyXbAXwIvA9YCNye5uqpWTzr0ismTzvevkPx94GCggP/Tn/vNzYnJCpkkSWpnoobzmdmLgLur6p6q+j7wQeBVc4z4l4B/rKpH+iTsH4FXbHL7eyZkkiRp7CRZlGTVwGfRwO5nA/cPrK/tt032a0luS7I0yZ4bee5GsctSkiS1M6RB/VW1GFi8GZf4CHB5VT2W5E107/T+ofd4zxcrZJIkqZlGg/ofAPYcWN+j3/bvcVV9o6oe61cvAH5+ruduChMySZK0rbkZeF6SvZPsAJwMXD14QJLdB1aPAb7UL18LvDzJM5I8A3h5v22z2GUpSZLaaTAPWVU9keRMukRqO+DCqrojybuBVVV1NfDWJMcATwCPAKf15z6S5A/pkjqAd1fVI5sbkwmZJEna5lTVNcA1k7b93sDyO4F3TnPuhcCF8xmPCZkkSWpmLpO4bgtMyCRJUju+OglwUL8kSVJzVsgkSVIzZYUMgFTZdzsLvyBJ0rYkW/Jm33jlS4by9+wuH7l+i7Zjc1khm4Pj9zqmdQhDcdW9V/OUHTb7bQ9brSe+/wDP3/Xg1mEMxZe/vgqAx9fd0ziS4dh+wT4AHLnH0Y0jGY4Va68D4OV7bvbr77ZKH7//Y7xx4QmtwxiaC9cs5bV7Hdc6jKG47N5lW/6mVsgAx5BJkiQ1Z4VMkiQ14xiyjgmZJElqx4QMsMtSkiSpOStkkiSpGbssO1bIJEmSGrNCJkmSmrFC1jEhkyRJzZiQdeyylCRJaswKmSRJaqdG6g1HQ2OFTJIkqTErZJIkqRnHkHVMyCRJUjM1YZcl2GUpSZLUnBUySZLUjF2WHStkkiRJjVkhkyRJzZTTXgBWyCRJkpqzQiZJkppxDFnHhEySJDXjtBcduywlSZIas0ImSZKaqWodwdbBCpkkSVJjTRKyJBcnOaFfviDJfv3yOZOOWznP9700yV1JvpjkwiTbz+f1JUnSxqmJDOUzappXyKrqjKpa3a+eM2nfYfN8u0uBfYGfBXYEzpjn60uSpI1gQtaZU0KW5NQktyW5NcklSRYmWd5v+0SS5/THXZzk/CQrk9wzUAVLkvf21anrgGcOXHtFkoOTnAfsmOSWJJf2+x4dOP89fWXr9iQn9duP7M9fmuTOvgI27a9CVV1TPeAmYI9N+9okSZLmz6yD+pPsD7wLOKyq1iXZGVgCLKmqJUneCJwPHNufsjtwBF0l6mpgKXAc8AJgP2A3YDVw4eB9quodSc6sqgOnCON44EDgAGABcHOSG/p9BwH7Aw8CnwYOBz41S5u2B14PvG2a/YuARQDvf//7Z7qUJEnaDA7q78ylQnYUcGVVrQOoqkeAQ4HL+v2X0CVgG3y4qib6bsjd+m0vBi6vqvVV9SCwfCPjPGLg/IeB64FD+n03VdXaqpoAbgEWzuF6fwXcUFU3TrWzqhZX1cFVdfCiRYs2MlRJkqSNM4xpLx4bWN4SnbiD91vPLG1K8vvArsCbhhmUJEma3SiO9xqGuVTIlgMnJtkFoO+yXAmc3O8/BZiy0jTgBuCkJNsl2R146TTHPT7Nk483Dpy/K13F7aY5xP4kSc4Afgl4TV9RkyRJDVVlKJ9RM2uFrKruSHIucH2S9cAXgLcAFyU5C/g6cPosl1lG1/W5GrgP+Mw0xy0Gbkvy+ao6ZdL5hwK3AgW8vaoeSrLvbPFP8tfAvcBn+rH/V1XVuzfyGpIkSfNqTl2WVbWEbiD/oKOmOO60Ses79T8LOHOaax85sHw2cPY055/VfwbPXQGsGFif8h4D+30zgSRJWxH7qzrN5yGTJEna1o1lxSjJMmDvSZvPrqprW8QjSZKmNjGC472GYSwTsqo6rnUMkiRJczWWCZkkSRoNo/hE5DCYkEmSpGach6zjoH5JkqTGrJBJkqRmfJdlxwqZJElSY1bIJElSM44h65iQSZKkZpyHrGOXpSRJUmNWyCRJUjPOQ9axQiZJktSYFTJJktSM0150TMgkSVIzDurv2GUpSZLUmBUySZLUjIP6O1bIJEmSGrNCJkmSmnFQf8cKmSRJUmMpU9PZ+AVJkrYlW3RQ16o9jh3K37MHr/3wSA1Os8tyDj7yrNe0DmEoXvnQ5RzwrMNahzE0tz60kpfv+YrWYQzFx+//GABH7nF040iGY8Xa6wB4fN09jSMZju0X7APAa/c6rnEkw3HZvcv4zYWvbh3G0PzVmg/xGwtPbB3GUPzNmiu3+D0d1N+xy1KSJKkxK2SSJKkZJ4btWCGTJElqzAqZJElqxifnOiZkkiSpGbssO3ZZSpIkNWaFTJIkNeO0Fx0rZJIkSY2ZkEmSpGYmhvSZTZJXJLkryd1J3jHF/v+aZHWS25J8IsleA/vWJ7ml/1y9qW0fZJelJElqprbsm5oASLId8JfAy4C1wM1Jrq6q1QOHfQE4uKq+m+TNwJ8AJ/X7vldVB85nTFbIJEnStuZFwN1VdU9VfR/4IPCqwQOq6pNV9d1+9bPAHsMMyIRMkiQ1M1HD+SRZlGTVwGfRwG2fDdw/sL623zadXwf+YWD9R/trfjbJsfPxPdhlKUmSxk5VLQYWb+51krwOOBh4ycDmvarqgST7AMuT3F5V/7w59zEhkyRJzUw0GEMGPADsObC+R7/tSZIcDfwu8JKqemzD9qp6oP95T5IVwEHAZiVkdllKkqRtzc3A85LsnWQH4GTgSU9LJjkIeD9wTFV9bWD7M5I8tV9eABwODD4MsEmskEmSpGZaPGVZVU8kORO4FtgOuLCq7kjybmBVVV0NvAfYCbgyCcB9VXUM8NPA+5NM0BW2zpv0dOYmMSGTJEnNzGXOsGGoqmuAayZt+72B5aOnOW8l8LPzHY9dlpIkSY1ZIZMkSc206LLcGlkhkyRJaswKmSRJaqbVGLKtjQmZJElqxoSsY5elJElSY1bIJElSMw7q7zSpkCW5OMkJ/fIFSfbrl8+ZdNzKeb7v/0pya5LbkixNstN8Xl+SJGlTNO+yrKozBma4PWfSvsPm+Xb/paoOqKoXAvcBZ87z9SVJ0kaYyHA+o2ZOCVmSU/uq0q1JLkmyMMnyftsnkjynP+7iJOcnWZnknoEqWJK8N8ldSa4Dnjlw7RVJDk5yHrBjkluSXNrve3Tg/Pck+WKS25Oc1G8/sj9/aZI7k1ya/v0GU6mqb2+4HrAjUNO0d1GSVUlWLV682S+KlyRJ05ggQ/mMmlnHkCXZH3gXcFhVrUuyM7AEWFJVS5K8ETgfOLY/ZXfgCGBfuhd1LgWOA14A7AfsRvcSzgsH71NV70hyZlUdOEUYxwMHAgcAC4Cbk9zQ7zsI2B94EPg03Us+PzVDey4CfqWP4f+d6piqWgxsyMTqI7/3yekuJ0mStNnmUiE7CriyqtYBVNUjwKHAZf3+S+gSsA0+XFUTfTfkbv22FwOXV9X6qnoQWL6RcR4xcP7DwPXAIf2+m6pqbVVNALcAC2e6UFWdDvwk8CXgpI2MQ5IkzaMa0mfUDGMM2WMDy1uiZjh4v/XMoepXVeuBDwK/NqygJEmS5mouCdly4MQkuwD0XZYrgZP7/acAN85yjRuAk5Jsl2R34KXTHPd4ku2n2H7jwPm70lXcbppD7D/Qj0N77oZl4Bjgzo25hiRJml8TQ/qMmrlUk+5Ici5wfZL1wBeAtwAXJTkL+Dpw+iyXWUbX9bma7unGz0xz3GLgtiSfr6pTJp1/KHArXSXy7VX1UJJ9Z4t/QIAlSZ7eL98KvHkjzpckSRqKOU0MW1VL6AbyDzpqiuNOm7S+U/+zmGaKiao6cmD5bODsac4/q/8MnrsCWDGwPu00Fv0Ys8On2y9Jkra8ieknR9imOFO/JElqZhQH4A/DWCZkSZYBe0/afHZVXdsiHkmSpJmMZUJWVce1jkGSJM1uFAfgD0PzVydJkiRt68ayQiZJkkbDKL53chhMyCRJUjOj+N7JYbDLUpIkqTErZJIkqRmnvehYIZMkSWrMCpkkSWrGQf0dEzJJktSM85B17LKUJElqzAqZJElqxkH9HStkkiRJjVkhkyRJzTiov2NCJkmSmnFQf8cuS0mSpMaskEmSpGaskHWskEmSJDWWKh84nYVfkCRpW7JFh9n/9Z6vG8rfs//5/g+M1OMCVsgkSZIacwzZHFz07Ne1DmEoTn/gAxz67Je2DmNoPvPAJ/kKUG2pAAAal0lEQVTV5/yn1mEMxd/f91EAXr7nKxpHMhwfv/9jALx2r+MaRzIcl927DIDH193TOJLh2H7BPpy58KTWYQzNe9dcwZsWntg6jKF4/5ort/g9HUPWMSGTJEnNmJB17LKUJElqzAqZJElqxifnOlbIJEmSGrNCJkmSmvFdlh0TMkmS1IyD+jt2WUqSJDVmhUySJDVjhaxjhUySJKkxK2SSJKkZp73omJBJkqRmfMqyY5elJElSY1bIJElSMw7q71ghkyRJaswKmSRJasZB/R0rZJIkSY1ZIZMkSc1MWCMDTMgkSVJDDurv2GUpSZLUmBUySZLUjB2WHStkkiRJjVkhkyRJzTiGrGNCJkmSmvFdlp0mXZZJLk5yQr98QZL9+uVzJh23ckj3Pz/Jo8O4tiRJ0sZqPoasqs6oqtX96jmT9h023/dLcjDwjPm+riRJ2ngT1FA+o2ZOCVmSU5PcluTWJJckWZhkeb/tE0me0x93cV99WpnknoEqWJK8N8ldSa4Dnjlw7RVJDk5yHrBjkluSXNrve3Tg/Pck+WKS25Oc1G8/sj9/aZI7k1yaZNriZ5LtgPcAb5+lvYuSrEqyavHixXP5iiRJkjbZrGPIkuwPvAs4rKrWJdkZWAIsqaolSd4InA8c25+yO3AEsC9wNbAUOA54AbAfsBuwGrhw8D5V9Y4kZ1bVgVOEcTxwIHAAsAC4OckN/b6DgP2BB4FPA4cDn5qmOWcCV1fVV2fI26iqxcCGTKwu+m83THusJEnadKNXyxqOuVTIjgKurKp1AFX1CHAocFm//xK6BGyDD1fVRN8NuVu/7cXA5VW1vqoeBJZvZJxHDJz/MHA9cEi/76aqWltVE8AtwMKpLpDkJ4ETgb/YyHtLkqQhmRjSZ9QMYwzZYwPLW+LZicH7rWf6qt9BwHOBu5OsAZ6W5O4hxyZJkjSruSRky4ETk+wC0HdZrgRO7vefAtw4yzVuAE5Ksl2S3YGXTnPc40m2n2L7jQPn70pXcbtpDrH/QFV9tKqeVVULq2oh8N2qeu7GXEOSJM2vVoP6k7yiH9t+d5J3TLH/qUmu6Pd/LsnCgX3v7LffleSX5uN7mHUMWVXdkeRc4Pok64EvAG8BLkpyFvB14PRZLrOMrutzNXAf8JlpjlsM3Jbk81V1yqTzDwVupetufntVPZRk39nilyRJGtQ/5PeXwMuAtXRj068emPUB4NeBb1bVc5OcDPwxXXFoP7qi1P7ATwLXJXl+Va3fnJjmNDFsVS2hG8g/6Kgpjjtt0vpO/c+iG1A/1bWPHFg+Gzh7mvPP6j+D564AVgysT3mPae6701yPlSRJw9FoUP+LgLur6h6AJB8EXkVXONrgVcAf9MtLgff2Mzm8CvhgVT0GfKUf/vQipi82zUnzecgkSZK2sGcD9w+sr+23TXlMVT0B/AuwyxzP3Whj+eqkJMuAvSdtPruqrm0RjyRJmtqwnohMsghYNLBpcT+t1VZpLBOyqjqudQySJGl2w5pVf9KcopM9AOw5sL5Hv22qY9YmeQrw48A35njuRrPLUpIkbWtuBp6XZO8kO9AN0r960jFXA2/ol08Alvdj2q8GTu6fwtwbeB4bOfPDVMayQiZJkkZDi0H9VfVEkjOBa4HtgAv7WSXeDayqqquB/wVc0g/af4R+uq/+uA/RPQDwBPBbm/uEJZiQSZKkbVBVXQNcM2nb7w0s/xvdG36mOvdc4Nz5jMeETJIkNTOKrzkaBhMySZLUTPl6ccBB/ZIkSc1ZIZMkSc3YZdmxQiZJktSYFTJJktTMsCaGHTUmZJIkqRnTsY5dlpIkSY1ZIZMkSc3YZdmxQiZJktSYFTJJktSM0150rJBJkiQ1ZoVMkiQ146uTOiZkkiSpGbssO6kyM52FX5AkaVuSLXmzNy48YSh/z164ZukWbcfmskI2B+9c+NrWIQzF/1hzGa/b6/jWYQzNB+69ijMWntA6jKG4YM1SAN44pu27sG/fby58deNIhuOv1nwIgDMXntQ4kuF475oreHzdPa3DGJrtF+zD2xae3DqMofjzNR/c4ve0y7LjoH5JkqTGrJBJkqRmHEPWMSGTJEnNTDiWHbDLUpIkqTkrZJIkqRnrYx0rZJIkSY1ZIZMkSc1MWCMDTMgkSVJDzkPWsctSkiSpMStkkiSpGech61ghkyRJaswKmSRJasZB/R0rZJIkSY1ZIZMkSc34lGXHhEySJDXjoP6OXZaSJEmNWSGTJEnNVNllCVbIJEmSmrNCJkmSmnHai44JmSRJasZB/R27LCVJkhqzQiZJkppxHrKOFTJJkqTGmiRkSS5OckK/fEGS/frlcyYdt3II9/1Kklv6z4HzeX1JkrRxJqihfEZN8y7LqjpjYPUc4I8G9h02hFueVVVLh3BdSZK0kZyHrDOnClmSU5PcluTWJJckWZhkeb/tE0me0x93cZLzk6xMcs9AFSxJ3pvkriTXAc8cuPaKJAcnOQ/Ysa9cXdrve3Tg/Pck+WKS25Oc1G8/sj9/aZI7k1yaJPP7FUmSJA3XrAlZkv2BdwFHVdUBwNuAvwCWVNULgUuB8wdO2R04AvhV4Lx+23HAC4D9gFOBH6p8VdU7gO9V1YFVdcqk3ccDBwIHAEcD70mye7/vIOC3+2vvAxw+S5PO7RPJP03y1GnavCjJqiSrFi9ePMvlJEnSppoY0mfUzKVCdhRwZVWtA6iqR4BDgcv6/ZfQJWAbfLiqJqpqNbBbv+3FwOVVtb6qHgSWb2ScRwyc/zBwPXBIv++mqlpbVRPALcDCGa7zTmDf/tydgbOnOqiqFlfVwVV18KJFizYyVEmSpI0zjEH9jw0sb4nuw8H7rWeGcXFV9dXqPAZcBLxo2MFJkqTp1ZD+GzVzSciWAycm2QUgyc7ASuDkfv8pwI2zXOMG4KQk2/VdjS+d5rjHk2w/xfYbB87fla7idtMcYn+SDd2c/TizY4Evbuw1JEmS5tusT1lW1R1JzgWuT7Ie+ALwFuCiJGcBXwdOn+Uyy+i6PlcD9wGfmea4xcBtST4/aRzZMrpu0luBAt5eVQ8l2Xe2+Ce5tE/oQte9+Z838nxJkjSPRnGKimGY07QXVbUEWDJp81FTHHfapPWd+p8FnDnNtY8cWD6bgXFdk84/q/8MnrsCWDGwPuU9Bvb/UMySJKkdp73oOFO/JElSY80nhh2GJMuAvSdtPruqrm0RjyRJmppdlp2xTMiq6rjWMUiSJM3VWCZkkiRpNIziFBXDYEImSZKamXBQP+CgfkmSpOaskEmSpGasj3WskEmSJDVmhUySJDXjtBcdEzJJktSMCVnHLktJkqTGrJBJkqRmfJdlxwqZJElSY1bIJElSM44h61ghkyRJaswKmSRJasZ3WXZMyCRJUjMO6u/YZSlJktSYFTJJktSMg/o7VsgkSZIai323s/ILkiRtS7Ilb3bQsw4fyt+zX3jo05vcjiQ7A1cAC4E1wKur6puTjjkQeB/wdGA9cG5VXdHvuxh4CfAv/eGnVdUtM93TCpkkSWpmghrKZzO9A/hEVT0P+ES/Ptl3gVOran/gFcCfJfmJgf1nVdWB/WfGZAwcQzYnr9/r+NYhDMUl917F8Xsd0zqMobnq3qvH+tcO4LV7Hdc4kuG47N5lAPzGwhMbRzIcf7PmSgDeNKbte/+aK3nbwpNbhzE0f77mgzy+7p7WYQzF9gv2aR3C1uJVwJH98hJgBXD24AFV9eWB5QeTfA3YFfjWptzQCpkkSWqmhvRfkkVJVg18Fm1EWLtV1Vf75YeA3WY6OMmLgB2Afx7YfG6S25L8aZKnznZDK2SSJGnsVNViYPF0+5NcBzxril2/O+k6lWTaPtAkuwOXAG+oqol+8zvpErkd+hjOBt49U7wmZJIkqZmJRg8XVtXR0+1L8nCS3avqq33C9bVpjns68FHgd6vqswPX3lBdeyzJRcDvzBaPXZaSJKmZYXVZbqargTf0y28A/m7yAUl2AJYBf1tVSyft273/GeBY4Iuz3dCETJIk6cnOA16W5J+Ao/t1khyc5IL+mFcDLwZOS3JL/zmw33dpktuB24EFwH+f7YZ2WUqSpGZadVnOpKq+AfziFNtXAWf0yx8APjDN+Udt7D2tkEmSJDVmhUySJDUzD+O9xoIVMkmSpMaskEmSpGa2xjFkLZiQSZKkZuyy7NhlKUmS1JgVMkmS1Ixdlh0rZJIkSY1ZIZMkSc04hqxjQiZJkpqpmmgdwlbBLktJkqTGrJBJkqRmJuyyBKyQSZIkNWeFTJIkNVNOewGYkEmSpIbssuzYZSlJktSYFTJJktSMXZadJhWyJBcnOaFfviDJfv3yOZOOWznP902Sc5N8OcmXkrx1Pq8vSZK0KZpXyKrqjIHVc4A/Gth32Dzf7jRgT2DfqppI8sx5vr4kSdoIvsuyM6cKWZJTk9yW5NYklyRZmGR5v+0TSZ7TH3dxkvOTrExyz0AVLEnem+SuJNcBzxy49ookByc5D9gxyS1JLu33PTpw/nuSfDHJ7UlO6rcf2Z+/NMmdSS5Nkhma8mbg3dVPC1xVX5umvYuSrEqyavHixXP5iiRJ0iaoIf03amatkCXZH3gXcFhVrUuyM7AEWFJVS5K8ETgfOLY/ZXfgCGBf4GpgKXAc8AJgP2A3YDVw4eB9quodSc6sqgOnCON44EDgAGABcHOSG/p9BwH7Aw8CnwYOBz41TXN+CjgpyXHA14G3VtU/TT6oqhYDGzKxuvHcj0339UiSJG22uVTIjgKurKp1AFX1CHAocFm//xK6BGyDD1fVRFWtpku+AF4MXF5V66vqQWD5RsZ5xMD5DwPXA4f0+26qqrV91esWYOEM13kq8G9VdTDwN0xKCiVJ0pZVVUP5jJphDOp/bGB5pu7DYdxvPTNX/dYCV/XLy4AXDisoSZKkuZpLQrYcODHJLgB9l+VK4OR+/ynAjbNc4wa6rsLtkuwOvHSa4x5Psv0U228cOH9XuorbTXOIfbIPD9z7JcCXN+EakiRpnkxQQ/mMmlnHkFXVHUnOBa5Psh74AvAW4KIkZ9GNxTp9lssso+v6XA3cB3xmmuMWA7cl+XxVnTLp/EOBW4EC3l5VDyXZd7b4JzkPuDTJfwEeBc6Y5XhJkqShm9O0F1W1hG4g/6CjpjjutEnrO/U/CzhzmmsfObB8NnD2NOef1X8Gz10BrBhYn/IeA/u/BfynmY6RJElbziiO9xqG5vOQSZKkbZfzkHXGMiFLsgzYe9Lms6vq2hbxSJIkzWQsE7KqOq51DJIkaXZ2WXaavMtSkiRJ/24sK2SSJGk0jOIUFcNgQiZJkpqxy7Jjl6UkSVJjVsgkSVIzTnvRsUImSZLUmBUySZLUTDmoHzAhkyRJDdll2bHLUpIkqTErZJIkqRmnvehYIZMkSWrMCpkkSWrGQf0dK2SSJEmNWSGTJEnNOIasY0ImSZKaMSHr2GUpSZLUWMxMZ+UXJEnalmRL3uwpOzx7KH/PPvH9B7ZoOzaXCdlWJsmiqlrcOo5hGef2jXPbwPaNOts3usa5bfp3dllufRa1DmDIxrl949w2sH2jzvaNrnFum3omZJIkSY2ZkEmSJDVmQrb1GfdxAuPcvnFuG9i+UWf7Rtc4t009B/VLkiQ1ZoVMkiSpMRMySZKkxkzIJEmSGjMhkyRJasyEbCuRZK8kR/fLOyb5sdYxSZKkLcOEbCuQ5DeApcD7+017AB9uF9HmS/KUJG9K8rEkt/Wff0jyn5Ns3zq+YUoy8o+oJ9mu//X7wySHT9r3rlZxzZckT0vy9iRnJfnRJKcluTrJnyTZqXV8w5Dky61jmA9JXjiwvH2Sd/W/dn+U5GktY5sPSc5MsqBffm6SG5J8K8nnkvxs6/g0PE57sRVIcgvwIuBzVXVQv+32qhrZ//mSXA58C1gCrO037wG8Adi5qk5qFdt8SLLzdLuAW6tqjy0Zz3xLcgHwNOAm4PXA9VX1X/t9n6+qn2sZ3+ZK8iHgfmBH4AXAl4ArgGOAZ1XV6xuGt9mSfAfY8If7hhcsPw34LlBV9fQmgc2Dwd9/Sf5/YBfgIuBYYJeqOrVlfJsryR1VtX+//FHggqpaluRI4NyqOnzGC2hkPaV1AALgsar6ftL9uZnkKfz7H6aj6uer6vmTtq0FPjsm/1L/OnAv//6XHXS/ZgGe2SSi+fWiqnohQJL3An+V5CrgNTy5zaPq+VX16nT/030VOLqqKsmngFsbxzYfLgJ+Ajirqh4GSPKVqtq7bVjzYvD33y8Ch1TV40luYDx+7Qb/Xn5mVS0DqKoVDmUZb3ZZbh2uT3IOsGOSlwFXAh9pHNPmeiTJiUl+8HssyY8kOQn4ZsO45ss9wJFVtffAZ5/+L7yHWwc3D3bYsFBVT1TVIuAWYDkwNl161XURXNP/3LA+6v8YoqreCvw5cHmSt/b/H458u3o/nuS4JL8GPLWqHofx+bUDlia5OMk+wLIkv92PMT4duK91cBoeE7KtwzvoKi63A28CrgFGfZzOycAJwMNJvtxXxR4Cju/3jbo/A54xzb4/2ZKBDMmqJK8Y3FBV76arvCxsEtH8WrVhrFhVvXHDxiQ/BXynWVTzqKr+D3B0v3o98KMNw5lP19N1Lf8qXcV9N4AkzwLWtQxsPlTV7wIrgMuB/wr8IfAPwPOAU9pFpmFzDNlWIMl/AP6tqtb369vR/cvvu20jmx9JdgGoqm9Mse9lVfWPWz6qLcP2jZ4k2VAxG5f2JdkdOKiqrpm0fSzaN5VxbhuMf/u2RSZkW4Ekn6Ubw/Jov74T8PGqOqxtZMM3DgPEZ2L7RpvtG13j3DYY//Zti+yy3Dr86IZkDKBfHvnHt+doHAaIz8T2jTbbN7rGuW0w/u3b5piQbR3+NckP/qWT5OeB7zWMZ0sa9xKt7Rtttm90jXPbYPzbt81x2outw28DVyZ5kO5fPc8CRnqeLkmSNHcmZFuBqro5yb50E1QC3LXhUe5twJrWAQzZmtYBDNma1gEM2ZrWAQzZmtYBDNGa1gEM2ZrWAWh+Oai/oSRHVdXyJMdPtb+qrtrSMQ1DksPopkr4wT8AqupvmwU0z2zfaLN9o2uc2wbj3z49mRWytl5CN9HmK6fYV8DIJ2RJLgF+im5S0fX95gLG4g8V2zfabN/oGue2wfi3Tz/MCllj/QzaJ1TVh1rHMgxJvgTsV2P6G832jTbbN7rGuW0w/u3TD/Mpy8aqagJ4e+s4huiLdA8pjCvbN9ps3+ga57bB+LdPk9hluXW4LsnvAFcA/7phY1U90i6kebMAWJ3kJuCxDRur6ph2Ic0r2zfabN/oGue2wfi3T5PYZbkVSPIVpphTpqr2aRDOvErykqm2V9X1WzqWYbB9o832ja5xbhuMf/v0w0zItgJJdgR+EziCLjG7EfjrqhqLyWH7l/8e0q/eVFVfaxnPfLN9o832ja5xbhuMf/v0ZI4h2zosAX4aOB/4C2C/ftvIS/Jq4CbgRODVwOeSnNA2qvlj+0ab7Rtd49w2GP/26YdZIdsKJFldVfvNtm0UJbkVeNmGf9kl2RW4rqoOaBvZ/LB9o832ja5xbhuMf/v0w6yQbR0+n+QXNqwk+Y/AqobxzKcfmVRm/wbj9fvO9o022ze6xrltMP7t0yQ+Zbl1+HlgZZL7+vXnAHcluR2oqnphu9A228eSXAtc3q+fBFzTMJ75ZvtGm+0bXePcNhj/9mkSuyy3Akn2mml/Vd27pWIZhiS/Bhzer95YVctaxjPfbN9os32ja5zbBuPfPj2ZCZkkSVJjdllqKJJ8qqqOSPIdnjzHWui6YZ/eKLR5Yfts39ZsnNs3zm2D8W+fpmeFTJIkqTGf2NBQJblkLttGle0bbbZvdI1z22D826cfZkKmYdt/cCXJU+ieKh0Xtm+02b7RNc5tg/FvnyYxIdNQJHlnPwbihUm+3X++AzwM/F3j8Dab7Rtttm90jXPbYPzbp+k5hkxDleR/VNU7W8cxLLZvtNm+0TXObYPxb59+mAmZhiLJvlV1Z5Kfm2p/VX1+S8c0n2yf7duajXP7xrltMP7t0/RMyDQUSf6mqn4jySen2F1VddQWD2oe2T7btzUb5/aNc9tg/Nun6ZmQSZIkNebEsBqKJMfPtL+qrtpSsQyD7bN9W7Nxbt84tw3Gv32angmZhuWV/c9nAocBy/v1lwIrgVH/Q8X2jTbbN7rGuW0w/u3TNEzINBRVdTpAko8D+1XVV/v13YGLG4Y2L2zfaLN9o2uc2wbj3z5Nz3nINGx7bvgDpfd/27tDFyuiKADj39EuaFpk0W4QjRssBptFEMsmu+A/YdOw+AeIySCyoklQg0GrSYM20wqraBBM1+A8cGeCZS6Xc/h+8MKddD4WHnfvmzfvADgzapgO7MvNvrwqt0H9Ps14QqbeXkXEC+DRtL4BvBw4z9rsy82+vCq3Qf0+zfgtS3U33aR6aVq+aa3tj5xnbfblZl9eldugfp+OckMmSZI0mPeQqauIuBYRnyLix+Y32SLi5+i51mJfbvblVbkN6vdpyRMydRURn4GrrbWPo2fpwb7c7MurchvU79OSJ2Tq7aD4G4p9udmXV+U2qN+nGU/I1FVE7AFbwFPg9+Z6ladN25ebfXlVboP6fVrysRfq7QTwC7jyz7VGnadN25ebfXlVboP6fZrxhEySJGkw7yFTVxGxHRH7EfF1ej2JiO3Rc63Fvtzsy6tyG9Tv05IbMvX2AHgGnJ5ez6drVdiXm315VW6D+n2a8SNLdRUR71trF/53LSv7crMvr8ptUL9PS56QqbfDiNiNiOPTaxc4HD3UiuzLzb68KrdB/T7NeEKmriLiLHAf2OHvN4TeArdaa1+GDrYS+3KzL6/KbVC/T0tuyNRVRDwEbrfWvk/rU8Dd1trNsZOtw77c7MurchvU79OSH1mqt/ObNxSA1to34OLAedZmX2725VW5Der3acYNmXo7FhEnN4vpv7xKDyS2Lzf78qrcBvX7NOMfV73dA95FxONpfR24M3CetdmXm315VW6D+n2a8R4ydRcR54DL0/J1a+3DyHnWZl9u9uVVuQ3q9+koN2SSJEmDeQ+ZJEnSYG7IJEmSBnNDJkmSNJgbMkmSpMH+AM9yWB7VKAnIAAAAAElFTkSuQmCC
                              "
                              >
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>
                              <div class="cell border-box-sizing code_cell rendered">
                              <div class="input">
                              <div class="prompt input_prompt">In&nbsp;[21]:</div>
                              <div class="inner_cell">
                                  <div class="input_area">
                              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_heat_title_status</span><span class="o">=</span><span class="n">df_heat</span><span class="p">[[</span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_0&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_1&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_2&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_3&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_4&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_5&quot;</span><span class="p">,</span><span class="s2">&quot;title_status_6&quot;</span><span class="p">]]</span>
                              <span class="c1">#encoded.select(&quot;price&quot;,&quot;condition_0&quot;,&quot;condition_1&quot;,&quot;condition_2&quot;,&quot;condition_3&quot;,&quot;condition_4&quot;,&quot;condition_5&quot;,&quot;condition_6&quot;).sample(False,0.0001,63).toPandas()</span>

                              <span class="n">matrix</span> <span class="o">=</span> <span class="n">df_heat_title_status</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
                              <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
                              <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                              <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Price vs Title Status&#39;</span><span class="p">)</span>
                              </pre></div>

                                  </div>
                              </div>
                              </div>

                              <div class="output_wrapper">
                              <div class="output">


                              <div class="output_area">

                                  <div class="prompt output_prompt">Out[21]:</div>




                              <div class="output_text output_subarea output_execute_result">
                              <pre>Text(0.5, 1.0, &#39;Price vs Title Status&#39;)</pre>
                              </div>

                              </div>

                              <div class="output_area">

                                  <div class="prompt"></div>




                              <div class="output_png output_subarea ">
                              <img src="data:image/png;base64,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
                              "
                              >
                              </div>

                              </div>

                              </div>
                              </div>

                              </div>

                            </div>
                </row>

    </div>
<!-- END SCROLLSPY -->


              <button class="btn btn-primary" data-dismiss="modal" type="button">
                <i class="fas fa-times"></i>
                Close</button>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



  <!-- Load Stage -->
  <section class="page-section" id="load">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">Load Stage</h2>
          <h3 class="section-subheading text-muted">Coming Soon!!</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <ul class="timeline">
            <li>
              <div class="timeline-image">
                <img class="rounded-circle img-fluid" src="img/about/1.jpg" alt="">
              </div>
              <div class="timeline-panel">
                <div class="timeline-heading">
                  <h4><i>Start</i></h4>
                  <h4 class="subheading">Raw Craiglist Data</h4>
                </div>
                <div class="timeline-body">
                  <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sunt ut voluptatum eius sapiente, totam reiciendis temporibus qui quibusdam, recusandae sit vero unde, sed, incidunt et ea quo dolore laudantium consectetur!</p>
                </div>
              </div>
            </li>
            <li class="timeline-inverted">
              <div class="timeline-image">
                <img class="rounded-circle img-fluid" src="img/about/4.jpg" alt="">
              </div>
              <div class="timeline-panel">
                <div class="timeline-heading">
                  <h4><i>End</i></h4>
                  <h4 class="subheading">Feature Engineered Data</h4>
                </div>
                <div class="timeline-body">
                  <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sunt ut voluptatum eius sapiente, totam reiciendis temporibus qui quibusdam, recusandae sit vero unde, sed, incidunt et ea quo dolore laudantium consectetur!</p>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- About Me -->
  <section class="bg-light page-section" id="about">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">About Me</h2>
          <h3 class="section-subheading text-muted">I got started on this project to learn more about Big Data processes. Along the
          way I've discovered a passion for full stack Development.</h3>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-sm-4">
          <div class="team-member">
            <img class="mx-auto rounded-circle" src="img/team/hckr.jpg" alt="">
            <h4>Devesh Sharma</h4>
            <p class="text-muted">Lead Developer</p>
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-facebook"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://github.com/devsharma96">
                  <i class="fab fa-github"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-linkedin"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-8 mx-auto text-center">
          <p class="large text-muted"></p>
        </div>
      </div>
    </div>
  </section>

  <!-- Tools -->
  <section class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-6">
          <a href="#">
            <img class="img-fluid d-block mx-auto" src="img/logos/python.png" alt="">
          </a>
        </div>
        <div class="col-md-3 col-sm-6">
          <a href="#">
            <img class="img-fluid d-block mx-auto" src="img/logos/jupyter.png" alt="">
          </a>
        </div>
        <div class="col-md-3 col-sm-6">
          <a href="#">
            <img class="img-fluid d-block mx-auto" src="img/logos/spark.png" alt="">
          </a>
        </div>
        <div class="col-md-3 col-sm-6">
          <a href="#">
            <img class="img-fluid d-block mx-auto" src="img/logos/s3.jpg" alt="">
          </a>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section class="page-section" id="contact">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2 class="section-heading text-uppercase">Contact Me</h2>
          <h3 class="section-subheading text-primary">For questions, ideas or just to talk!</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <form id="contactForm" name="sentMessage" novalidate="novalidate">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <input class="form-control" id="name" type="text" placeholder="Your Name *" required="required" data-validation-required-message="Please enter your name.">
                  <p class="help-block text-danger"></p>
                </div>
                <div class="form-group">
                  <input class="form-control" id="email" type="email" placeholder="Your Email *" required="required" data-validation-required-message="Please enter your email address.">
                  <p class="help-block text-danger"></p>
                </div>
                <div class="form-group">
                  <input class="form-control" id="phone" type="tel" placeholder="Your Phone *" required="required" data-validation-required-message="Please enter your phone number.">
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <textarea class="form-control" id="message" placeholder="Your Message *" required="required" data-validation-required-message="Please enter a message."></textarea>
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="clearfix"></div>
              <div class="col-lg-12 text-center">
                <div id="success"></div>
                <button id="sendMessageButton" class="btn btn-primary btn-xl text-uppercase" type="submit">Send Message</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-4">
          <span class="copyright">Copyright &copy; Devesh Sharma 2019</span>
        </div>
        <div class="col-md-4">
          <ul class="list-inline social-buttons">

            <li class="list-inline-item">
              <a href="#">
                <i class="fab fa-facebook"></i>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="https://github.com/devsharma96">
                <i class="fab fa-github"></i>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="#">
                <i class="fab fa-linkedin"></i>
              </a>
            </li>
          </ul>
        </div>
        <div class="col-md-4">
          <ul class="list-inline quicklinks">
            <li class="list-inline-item">
              <a href="#">Privacy Policy</a>
            </li>
            <li class="list-inline-item">
              <a href="#">Terms of Use</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Contact form JavaScript -->
  <script src="js/jqBootstrapValidation.js"></script>
  <script src="js/contact_me.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/agency.min.js"></script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          processEnvironments: true
      },
      // Center justify equations in code and markdown cells. Elsewhere
      // we use CSS to left justify single line equations in code cells.
      displayAlign: 'center',
      "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}},
          linebreaks: { automatic: true }
      }
  });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>

















</body>

</html>
